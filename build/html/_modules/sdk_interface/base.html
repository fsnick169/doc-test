

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sdk_interface.base &mdash; Portaldot Developer v1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=a6a68382" />
      <link rel="stylesheet" type="text/css" href="../../_static/fonts.css?v=5583d106" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5cb08e4e"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Portaldot Developer
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-sdk/index.html">Python SDK</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Portaldot Developer</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">sdk_interface.base</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sdk_interface.base</h1><div class="highlight"><pre>
<span></span><span class="c1"># Python Substrate Interface Library</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2018-2023 Stichting Polkascan (Polkascan Foundation).</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1"># http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hashlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">blake2b</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">websocket</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_connection</span><span class="p">,</span> <span class="n">WebSocketConnectionClosedException</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">scalecodec.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScaleBytes</span><span class="p">,</span> <span class="n">RuntimeConfigurationObject</span><span class="p">,</span> <span class="n">ScaleType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scalecodec.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">GenericCall</span><span class="p">,</span> <span class="n">GenericExtrinsic</span><span class="p">,</span> <span class="n">Extrinsic</span><span class="p">,</span> <span class="n">MultiAccountId</span><span class="p">,</span> <span class="n">GenericRuntimeCallDefinition</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scalecodec.type_registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_type_registry_preset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scalecodec.updater</span><span class="w"> </span><span class="kn">import</span> <span class="n">update_type_registries</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.extensions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Extension</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.interfaces</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExtensionInterface</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.storage</span><span class="w"> </span><span class="kn">import</span> <span class="n">StorageKey</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">SubstrateRequestException</span><span class="p">,</span> <span class="n">ConfigurationError</span><span class="p">,</span> <span class="n">StorageFunctionNotFound</span><span class="p">,</span> <span class="n">BlockNotFound</span><span class="p">,</span> \
    <span class="n">ExtrinsicNotFound</span><span class="p">,</span> <span class="n">ExtensionCallNotFound</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.constants</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.keypair</span><span class="w"> </span><span class="kn">import</span> <span class="n">Keypair</span><span class="p">,</span> <span class="n">KeypairType</span><span class="p">,</span> <span class="n">MnemonicLanguageCode</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils.ss58</span><span class="w"> </span><span class="kn">import</span> <span class="n">ss58_decode</span><span class="p">,</span> <span class="n">ss58_encode</span><span class="p">,</span> <span class="n">is_valid_ss58_address</span><span class="p">,</span> <span class="n">get_ss58_format</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SubstrateInterface&#39;</span><span class="p">,</span> <span class="s1">&#39;ExtrinsicReceipt&#39;</span><span class="p">,</span> <span class="s1">&#39;logger&#39;</span><span class="p">]</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">list_remove_iter</span><span class="p">(</span><span class="n">xs</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
    <span class="n">removed</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">():</span>
        <span class="k">nonlocal</span> <span class="n">removed</span>
        <span class="n">removed</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">):</span>
        <span class="n">removed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">yield</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">remove</span>
        <span class="k">if</span> <span class="n">removed</span><span class="p">:</span>
            <span class="n">xs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>


<div class="viewcode-block" id="SubstrateInterface">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">SubstrateInterface</span><span class="p">:</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">websocket</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ss58_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type_registry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type_registry_preset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">cache_region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">runtime_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_remote_preset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ws_options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">auto_discover</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">auto_reconnect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A specialized class in interfacing with a Substrate node.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        url: the URL to the substrate node, either in format https://127.0.0.1:9933 or wss://127.0.0.1:9944</span>
<span class="sd">        ss58_format: The address type which account IDs will be SS58-encoded to Substrate addresses. Defaults to 42, for Kusama the address type is 2</span>
<span class="sd">        type_registry: A dict containing the custom type registry in format: {&#39;types&#39;: {&#39;customType&#39;: &#39;u32&#39;},..}</span>
<span class="sd">        type_registry_preset: The name of the predefined type registry shipped with the SCALE-codec, e.g. kusama</span>
<span class="sd">        cache_region: a Dogpile cache region as a central store for the metadata cache</span>
<span class="sd">        use_remote_preset: When True preset is downloaded from GitHub master, otherwise use files from local installed scalecodec package</span>
<span class="sd">        ws_options: dict of options to pass to the websocket-client create_connection function</span>
<span class="sd">        config: dict of config flags to overwrite default configuration</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">url</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">websocket</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">url</span> <span class="ow">and</span> <span class="n">websocket</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either &#39;url&#39; or &#39;websocket&#39; must be provided&quot;</span><span class="p">)</span>

        <span class="c1"># Initialize lazy loading variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__version</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__properties</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__chain</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__token_decimals</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__token_symbol</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ss58_format</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">runtime_config</span><span class="p">:</span>
            <span class="n">runtime_config</span> <span class="o">=</span> <span class="n">RuntimeConfigurationObject</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span> <span class="o">=</span> <span class="n">runtime_config</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cache_region</span> <span class="o">=</span> <span class="n">cache_region</span>

        <span class="k">if</span> <span class="n">ss58_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ss58_format</span> <span class="o">=</span> <span class="n">ss58_format</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">type_registry_preset</span> <span class="o">=</span> <span class="n">type_registry_preset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_registry</span> <span class="o">=</span> <span class="n">type_registry</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">request_id</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">websocket</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Websocket connection options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ws_options</span> <span class="o">=</span> <span class="n">ws_options</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="s1">&#39;max_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws_options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ws_options</span><span class="p">[</span><span class="s1">&#39;max_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span>

        <span class="k">if</span> <span class="s1">&#39;read_limit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws_options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ws_options</span><span class="p">[</span><span class="s1">&#39;read_limit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span>

        <span class="k">if</span> <span class="s1">&#39;write_limit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws_options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ws_options</span><span class="p">[</span><span class="s1">&#39;write_limit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__rpc_message_queue</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;wss://&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ws://&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connect_websocket</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">websocket</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">websocket</span> <span class="o">=</span> <span class="n">websocket</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mock_extrinsics</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;content-type&#39;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
            <span class="s1">&#39;cache-control&#39;</span><span class="p">:</span> <span class="s2">&quot;no-cache&quot;</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transaction_version</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">block_id</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__metadata_cache</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;use_remote_preset&#39;</span><span class="p">:</span> <span class="n">use_remote_preset</span><span class="p">,</span>
            <span class="s1">&#39;auto_discover&#39;</span><span class="p">:</span> <span class="n">auto_discover</span><span class="p">,</span>
            <span class="s1">&#39;auto_reconnect&#39;</span><span class="p">:</span> <span class="n">auto_reconnect</span><span class="p">,</span>
            <span class="s1">&#39;rpc_methods&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;strict_scale_decode&#39;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>


        <span class="c1"># Initialize extension interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span> <span class="o">=</span> <span class="n">ExtensionInterface</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reload_type_registry</span><span class="p">(</span><span class="n">use_remote_preset</span><span class="o">=</span><span class="n">use_remote_preset</span><span class="p">,</span> <span class="n">auto_discover</span><span class="o">=</span><span class="n">auto_discover</span><span class="p">)</span>

<div class="viewcode-block" id="SubstrateInterface.connect_websocket">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.connect_websocket">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect_websocket</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        (Re)creates the websocket connection, if the URL contains a &#39;ws&#39; or &#39;wss&#39; scheme</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;wss://&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ws://&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="s2">&quot;Connecting to </span><span class="si">{}</span><span class="s2"> ...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">websocket</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">,</span>
                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">ws_options</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.close">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.close">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cleans up resources for this instance like active websocket connection and active extensions</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">websocket</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="s2">&quot;Closing websocket connection&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">websocket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">unregister_all</span><span class="p">()</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<div class="viewcode-block" id="SubstrateInterface.debug_message">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.debug_message">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">debug_message</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Submits a message to the debug logger</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message: str Debug message</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.supports_rpc_method">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.supports_rpc_method">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">supports_rpc_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if substrate RPC supports given method</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name: name of method to check</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rpc_methods&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;rpc_methods&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;rpc_methods&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;rpc_methods&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;methods&#39;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;rpc_methods&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="SubstrateInterface.rpc_request">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.rpc_request">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rpc_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">result_handler</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method that handles the actual RPC request to the Substrate node. The other implemented functions eventually</span>
<span class="sd">        use this method to perform the request.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        result_handler: Callback function that processes the result received from the node</span>
<span class="sd">        method: method of the JSONRPC request</span>
<span class="sd">        params: a list containing the parameters of the JSONRPC request</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        a dict with the parsed result of the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">request_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">request_id</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;jsonrpc&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span>
            <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">request_id</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="s1">&#39;RPC request #</span><span class="si">{}</span><span class="s1">: &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">request_id</span><span class="p">,</span> <span class="n">method</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">websocket</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">websocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
            <span class="k">except</span> <span class="n">WebSocketConnectionClosedException</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;auto_reconnect&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">:</span>
                    <span class="c1"># Try to reconnect websocket and retry rpc_request</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="s2">&quot;Connection Closed; Trying to reconnecting...&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">connect_websocket</span><span class="p">()</span>

                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">result_handler</span><span class="o">=</span><span class="n">result_handler</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># websocket connection is externally created, re-raise exception</span>
                    <span class="k">raise</span>

            <span class="n">update_nr</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">json_body</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">subscription_id</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">while</span> <span class="n">json_body</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Search for subscriptions</span>
                <span class="k">for</span> <span class="n">message</span><span class="p">,</span> <span class="n">remove_message</span> <span class="ow">in</span> <span class="n">list_remove_iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__rpc_message_queue</span><span class="p">):</span>

                    <span class="c1"># Check if result message is matching request ID</span>
                    <span class="k">if</span> <span class="s1">&#39;id&#39;</span> <span class="ow">in</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">request_id</span><span class="p">:</span>

                        <span class="n">remove_message</span><span class="p">()</span>

                        <span class="c1"># Check if response has error</span>
                        <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">message</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">])</span>

                        <span class="c1"># If result handler is set, pass result through and loop until handler return value is set</span>
                        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">result_handler</span><span class="p">):</span>

                            <span class="c1"># Set subscription ID and only listen to messages containing this ID</span>
                            <span class="n">subscription_id</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Websocket subscription [</span><span class="si">{</span><span class="n">subscription_id</span><span class="si">}</span><span class="s2">] created&quot;</span><span class="p">)</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">json_body</span> <span class="o">=</span> <span class="n">message</span>

                <span class="c1"># Process subscription updates</span>
                <span class="k">for</span> <span class="n">message</span><span class="p">,</span> <span class="n">remove_message</span> <span class="ow">in</span> <span class="n">list_remove_iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__rpc_message_queue</span><span class="p">):</span>
                    <span class="c1"># Check if message is meant for this subscription</span>
                    <span class="k">if</span> <span class="s1">&#39;params&#39;</span> <span class="ow">in</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;subscription&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">subscription_id</span><span class="p">:</span>

                        <span class="n">remove_message</span><span class="p">()</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Websocket result [</span><span class="si">{</span><span class="n">subscription_id</span><span class="si">}</span><span class="s2"> #</span><span class="si">{</span><span class="n">update_nr</span><span class="si">}</span><span class="s2">]: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                        <span class="c1"># Call result_handler with message for processing</span>
                        <span class="n">callback_result</span> <span class="o">=</span> <span class="n">result_handler</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">update_nr</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">callback_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">json_body</span> <span class="o">=</span> <span class="n">callback_result</span>

                        <span class="n">update_nr</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># Read one more message to queue</span>
                <span class="k">if</span> <span class="n">json_body</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__rpc_message_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">websocket</span><span class="o">.</span><span class="n">recv</span><span class="p">()))</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">result_handler</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ConfigurationError</span><span class="p">(</span><span class="s2">&quot;Result handlers only available for websockets (ws://) connections&quot;</span><span class="p">)</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">),</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span>
                    <span class="s2">&quot;RPC request failed with HTTP status code </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">))</span>

            <span class="n">json_body</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

            <span class="c1"># Check if response has error</span>
            <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">json_body</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">json_body</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">json_body</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;system_name&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__name</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__properties</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;system_properties&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__properties</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">chain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__chain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;system_chain&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chain</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__version</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;system_version&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__version</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">token_decimals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__token_decimals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__token_decimals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tokenDecimals&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__token_decimals</span>

    <span class="nd">@token_decimals</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">token_decimals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Token decimals must be an int&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__token_decimals</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">token_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__token_symbol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__token_symbol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tokenSymbol&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__token_symbol</span> <span class="o">=</span> <span class="s1">&#39;UNIT&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__token_symbol</span>

    <span class="nd">@token_symbol</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">token_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__token_symbol</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ss58_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ss58_format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ss58Format&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__ss58_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ss58Format&#39;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SS58Prefix&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__ss58_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SS58Prefix&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__ss58_format</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ss58_format</span>

    <span class="nd">@ss58_format</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ss58_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;ss58_format must be an int&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ss58_format</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">ss58_format</span> <span class="o">=</span> <span class="n">value</span>

<div class="viewcode-block" id="SubstrateInterface.implements_scaleinfo">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.implements_scaleinfo">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">implements_scaleinfo</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if current runtime implementation a `PortableRegistry` (`MetadataV14` and higher)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">portable_registry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_chain_head">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_chain_head">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_chain_head</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A pass-though to existing JSONRPC method `chain_getHead`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">supports_rpc_method</span><span class="p">(</span><span class="s2">&quot;chain_getHead&quot;</span><span class="p">):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;chain_getHead&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;chain_getBlockHash&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_chain_finalised_head">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_chain_finalised_head">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_chain_finalised_head</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A pass-though to existing JSONRPC method `chain_getFinalizedHead`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;chain_getFinalizedHead&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_block_hash">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_block_hash">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_block_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A pass-though to existing JSONRPC method `chain_getBlockHash`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_id</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;chain_getBlockHash&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">block_id</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_block_number">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_block_number">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_block_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A convenience method to get the block number for given block_hash</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;chain_getHeader&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">block_hash</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>

        <span class="k">elif</span> <span class="s1">&#39;result&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="s1">&#39;number&#39;</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_block_metadata">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_block_metadata">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_block_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decode</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A pass-though to existing JSONRPC method `state_getMetadata`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>
<span class="sd">        decode: True for decoded version</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">block_hash</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">block_hash</span><span class="p">]</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;state_getMetadata&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decode</span><span class="p">:</span>
            <span class="n">metadata_decoder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span>
                <span class="s1">&#39;MetadataVersioned&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">metadata_decoder</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">metadata_decoder</span>

        <span class="k">return</span> <span class="n">response</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_storage_by_key">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_storage_by_key">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_storage_by_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">storage_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A pass-though to existing JSONRPC method `state_getStorage`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>
<span class="sd">        storage_key</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">supports_rpc_method</span><span class="p">(</span><span class="s1">&#39;state_getStorageAt&#39;</span><span class="p">):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;state_getStorageAt&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">storage_key</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;state_getStorage&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">storage_key</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;result&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="s2">&quot;Unknown error occurred during retrieval of events&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_block_runtime_version">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_block_runtime_version">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_block_runtime_version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve the runtime version id of given block_hash</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">supports_rpc_method</span><span class="p">(</span><span class="s2">&quot;state_getRuntimeVersion&quot;</span><span class="p">):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;state_getRuntimeVersion&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">block_hash</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;chain_getRuntimeVersion&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">block_hash</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.generate_storage_hash">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.generate_storage_hash">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_storage_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">storage_function</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                              <span class="n">hashers</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a storage key for given module/function</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        storage_module</span>
<span class="sd">        storage_function</span>
<span class="sd">        params: Parameters of the storage function, provided in scale encoded hex-bytes or ScaleBytes instances</span>
<span class="sd">        hashers: Hashing methods used to determine storage key, defaults to &#39;Twox64Concat&#39; if not provided</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str Hexstring respresentation of the storage key</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Use StorageKey.generate() instead&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>

        <span class="n">storage_key</span> <span class="o">=</span> <span class="n">StorageKey</span><span class="o">.</span><span class="n">create_from_storage_function</span><span class="p">(</span>
            <span class="n">storage_module</span><span class="p">,</span> <span class="n">storage_function</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">runtime_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;0x</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">storage_key</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span></div>


<div class="viewcode-block" id="SubstrateInterface.convert_storage_parameter">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.convert_storage_parameter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">convert_storage_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale_type</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Use StorageKey.generate() instead&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">bytes</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;0x</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="n">scale_type</span> <span class="o">==</span> <span class="s1">&#39;AccountId&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;0x&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;0x</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ss58_decode</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss58_format</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">value</span></div>


    <span class="c1"># Runtime functions used by Substrate API</span>

<div class="viewcode-block" id="SubstrateInterface.init_runtime">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.init_runtime">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">init_runtime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">block_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method is used by all other methods that deals with metadata and types defined in the type registry.</span>
<span class="sd">        It optionally retrieves the block_hash when block_id is given and sets the applicable metadata for that</span>
<span class="sd">        block_hash. Also it applies all the versioned types at the time of the block_hash.</span>

<span class="sd">        Because parsing of metadata and type registry is quite heavy, the result will be cached per runtime id.</span>
<span class="sd">        In the future there could be support for caching backends like Redis to make this cache more persistent.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>
<span class="sd">        block_id</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">block_id</span> <span class="ow">and</span> <span class="n">block_hash</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot provide block_hash and block_id at the same time&#39;</span><span class="p">)</span>

        <span class="c1"># Check if runtime state already set to current block</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">block_hash</span> <span class="ow">and</span> <span class="n">block_hash</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">block_id</span> <span class="ow">and</span> <span class="n">block_id</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_id</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">block_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_block_hash</span><span class="p">(</span><span class="n">block_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">block_hash</span><span class="p">:</span>
            <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chain_head</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span> <span class="o">=</span> <span class="n">block_hash</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">block_id</span> <span class="o">=</span> <span class="n">block_id</span>

        <span class="c1"># In fact calls and storage functions are decoded against runtime of previous block, therefor retrieve</span>
        <span class="c1"># metadata and apply type registry of runtime of parent block</span>
        <span class="n">block_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s1">&#39;chain_getHeader&#39;</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">block_header</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BlockNotFound</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Block not found for &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

        <span class="n">parent_block_hash</span> <span class="o">=</span> <span class="n">block_header</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="s1">&#39;parentHash&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">parent_block_hash</span> <span class="o">==</span> <span class="s1">&#39;0x0000000000000000000000000000000000000000000000000000000000000000&#39;</span><span class="p">:</span>
            <span class="n">runtime_block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">runtime_block_hash</span> <span class="o">=</span> <span class="n">parent_block_hash</span>

        <span class="n">runtime_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_block_runtime_version</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">runtime_block_hash</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">runtime_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No runtime information for block &#39;</span><span class="si">{</span><span class="n">block_hash</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="c1"># Check if runtime state already set to current block</span>
        <span class="k">if</span> <span class="n">runtime_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;specVersion&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span> <span class="o">=</span> <span class="n">runtime_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;specVersion&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transaction_version</span> <span class="o">=</span> <span class="n">runtime_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;transactionVersion&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_region</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metadata_cache</span><span class="p">:</span>
            <span class="c1"># Try to retrieve metadata from Dogpile cache</span>
            <span class="n">cached_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_region</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;METADATA_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">cached_metadata</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="s1">&#39;Retrieved metadata for </span><span class="si">{}</span><span class="s1"> from Redis&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__metadata_cache</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">]</span> <span class="o">=</span> <span class="n">cached_metadata</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metadata_cache</span><span class="p">:</span>
            <span class="c1"># Get metadata from cache</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="s1">&#39;Retrieved metadata for </span><span class="si">{}</span><span class="s1"> from memory&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metadata_cache</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_block_metadata</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">runtime_block_hash</span><span class="p">,</span> <span class="n">decode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="s1">&#39;Retrieved metadata for </span><span class="si">{}</span><span class="s1"> from Substrate node&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">))</span>

            <span class="c1"># Update metadata cache</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metadata_cache</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_region</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="s1">&#39;Stored metadata for </span><span class="si">{}</span><span class="s1"> in Redis&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cache_region</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;METADATA_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>

        <span class="c1"># Update type registry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reload_type_registry</span><span class="p">(</span>
            <span class="n">use_remote_preset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;use_remote_preset&#39;</span><span class="p">),</span>
            <span class="n">auto_discover</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;auto_discover&#39;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Check if PortableRegistry is present in metadata (V14+), otherwise fall back on legacy type registry (&lt;V14)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">implements_scaleinfo</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="s1">&#39;Add PortableRegistry from metadata to type registry&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">add_portable_registry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>

        <span class="c1"># Set active runtime version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">set_active_spec_version_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">)</span>

        <span class="c1"># Check and apply runtime constants</span>
        <span class="n">ss58_prefix_constant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_constant</span><span class="p">(</span><span class="s2">&quot;System&quot;</span><span class="p">,</span> <span class="s2">&quot;SS58Prefix&quot;</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ss58_prefix_constant</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ss58_format</span> <span class="o">=</span> <span class="n">ss58_prefix_constant</span><span class="o">.</span><span class="n">value</span>

        <span class="c1"># Set runtime compatibility flags</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="s2">&quot;sp_weights::weight_v2::Weight&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;is_weight_v2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">update_type_registry_types</span><span class="p">({</span><span class="s1">&#39;Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;sp_weights::weight_v2::Weight&#39;</span><span class="p">})</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;is_weight_v2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">update_type_registry_types</span><span class="p">({</span><span class="s1">&#39;Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;WeightV1&#39;</span><span class="p">})</span></div>


<div class="viewcode-block" id="SubstrateInterface.query_map">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.query_map">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">query_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">storage_function</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">start_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">page_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
                  <span class="n">ignore_decoding_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;QueryMapResult&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterates over all key-pairs located at the given module and storage_function. The storage</span>
<span class="sd">        item must be a map.</span>

<span class="sd">        Example:</span>

<span class="sd">        ```</span>
<span class="sd">        result = substrate.query_map(&#39;System&#39;, &#39;Account&#39;, max_results=100)</span>

<span class="sd">        for account, account_info in result:</span>
<span class="sd">            print(f&quot;Free balance of account &#39;{account.value}&#39;: {account_info.value[&#39;data&#39;][&#39;free&#39;]}&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module: The module name in the metadata, e.g. System or Balances.</span>
<span class="sd">        storage_function: The storage function name, e.g. Account or Locks.</span>
<span class="sd">        params: The input parameters in case of for example a `DoubleMap` storage function</span>
<span class="sd">        block_hash: Optional block hash for result at given block, when left to None the chain tip will be used.</span>
<span class="sd">        max_results: the maximum of results required, if set the query will stop fetching results when number is reached</span>
<span class="sd">        start_key: The storage key used as offset for the results, for pagination purposes</span>
<span class="sd">        page_size: The results are fetched from the node RPC in chunks of this size</span>
<span class="sd">        ignore_decoding_errors: When set this will catch all decoding errors, set the item to None and continue decoding</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        QueryMapResult</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">block_hash</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Retrieve chain tip</span>
            <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chain_head</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="n">metadata_pallet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get_metadata_pallet</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">metadata_pallet</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">StorageFunctionNotFound</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pallet &quot;</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s1">&quot; not found&#39;</span><span class="p">)</span>

        <span class="n">storage_item</span> <span class="o">=</span> <span class="n">metadata_pallet</span><span class="o">.</span><span class="n">get_storage_function</span><span class="p">(</span><span class="n">storage_function</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">metadata_pallet</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">storage_item</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">StorageFunctionNotFound</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Storage function &quot;</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">storage_function</span><span class="si">}</span><span class="s1">&quot; not found&#39;</span><span class="p">)</span>

        <span class="n">value_type</span> <span class="o">=</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">get_value_type_string</span><span class="p">()</span>
        <span class="n">param_types</span> <span class="o">=</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">get_params_type_string</span><span class="p">()</span>
        <span class="n">key_hashers</span> <span class="o">=</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">get_param_hashers</span><span class="p">()</span>

        <span class="c1"># Check MapType condititions</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_types</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Given storage function is not a map&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_types</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Storage function map can accept max </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">param_types</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1"> parameters, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="si">}</span><span class="s1"> given&#39;</span><span class="p">)</span>

        <span class="c1"># Generate storage key prefix</span>
        <span class="n">storage_key</span> <span class="o">=</span> <span class="n">StorageKey</span><span class="o">.</span><span class="n">create_from_storage_function</span><span class="p">(</span>
            <span class="n">module</span><span class="p">,</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="n">runtime_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
        <span class="p">)</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="n">storage_key</span><span class="o">.</span><span class="n">to_hex</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">start_key</span><span class="p">:</span>
            <span class="n">start_key</span> <span class="o">=</span> <span class="n">prefix</span>

        <span class="c1"># Make sure if the max result is smaller than the page size, adjust the page size</span>
        <span class="k">if</span> <span class="n">max_results</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">max_results</span> <span class="o">&lt;</span> <span class="n">page_size</span><span class="p">:</span>
            <span class="n">page_size</span> <span class="o">=</span> <span class="n">max_results</span>

        <span class="c1"># Retrieve storage keys</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;state_getKeysPaged&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="n">prefix</span><span class="p">,</span> <span class="n">page_size</span><span class="p">,</span> <span class="n">start_key</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>

        <span class="n">result_keys</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">last_key</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">concat_hash_len</span><span class="p">(</span><span class="n">key_hasher</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key_hasher</span> <span class="o">==</span> <span class="s2">&quot;Blake2_128Concat&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">16</span>
            <span class="k">elif</span> <span class="n">key_hasher</span> <span class="o">==</span> <span class="s2">&quot;Twox64Concat&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">8</span>
            <span class="k">elif</span> <span class="n">key_hasher</span> <span class="o">==</span> <span class="s2">&quot;Identity&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unsupported hash type&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">last_key</span> <span class="o">=</span> <span class="n">result_keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="c1"># Retrieve corresponding value</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;state_queryStorageAt&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="n">result_keys</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">])</span>

            <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">result_group</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">result_group</span><span class="p">[</span><span class="s1">&#39;changes&#39;</span><span class="p">]:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># Determine type string</span>
                        <span class="n">key_type_string</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_types</span><span class="p">)):</span>
                            <span class="n">key_type_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[u8; </span><span class="si">{</span><span class="n">concat_hash_len</span><span class="p">(</span><span class="n">key_hashers</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span>
                            <span class="n">key_type_string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param_types</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>

                        <span class="n">item_key_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_scale</span><span class="p">(</span>
                            <span class="n">type_string</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">key_type_string</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                            <span class="n">scale_bytes</span><span class="o">=</span><span class="s1">&#39;0x&#39;</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">):],</span>
                            <span class="n">return_scale_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span>
                        <span class="p">)</span>

                        <span class="c1"># strip key_hashers to use as item key</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_types</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">item_key</span> <span class="o">=</span> <span class="n">item_key_obj</span><span class="o">.</span><span class="n">value_object</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">item_key</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                                <span class="n">item_key_obj</span><span class="o">.</span><span class="n">value_object</span><span class="p">[</span><span class="n">key</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_types</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                            <span class="p">)</span>

                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_decoding_errors</span><span class="p">:</span>
                            <span class="k">raise</span>
                        <span class="n">item_key</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">item_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_scale</span><span class="p">(</span>
                            <span class="n">type_string</span><span class="o">=</span><span class="n">value_type</span><span class="p">,</span>
                            <span class="n">scale_bytes</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                            <span class="n">return_scale_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span>
                        <span class="p">)</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_decoding_errors</span><span class="p">:</span>
                            <span class="k">raise</span>
                        <span class="n">item_value</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">item_key</span><span class="p">,</span> <span class="n">item_value</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">QueryMapResult</span><span class="p">(</span>
            <span class="n">records</span><span class="o">=</span><span class="n">result</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="n">page_size</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">storage_function</span><span class="o">=</span><span class="n">storage_function</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">,</span> <span class="n">substrate</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">last_key</span><span class="o">=</span><span class="n">last_key</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
            <span class="n">ignore_decoding_errors</span><span class="o">=</span><span class="n">ignore_decoding_errors</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.query_multi">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.query_multi">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">query_multi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_keys</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">StorageKey</span><span class="p">],</span> <span class="n">block_hash</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query multiple storage keys in one request.</span>

<span class="sd">        Example:</span>

<span class="sd">        ```</span>
<span class="sd">        storage_keys = [</span>
<span class="sd">            substrate.create_storage_key(</span>
<span class="sd">                &quot;System&quot;, &quot;Account&quot;, [&quot;F4xQKRUagnSGjFqafyhajLs94e7Vvzvr8ebwYJceKpr8R7T&quot;]</span>
<span class="sd">            ),</span>
<span class="sd">            substrate.create_storage_key(</span>
<span class="sd">                &quot;System&quot;, &quot;Account&quot;, [&quot;GSEX8kR4Kz5UZGhvRUCJG93D5hhTAoVZ5tAe6Zne7V42DSi&quot;]</span>
<span class="sd">            )</span>
<span class="sd">        ]</span>

<span class="sd">        result = substrate.query_multi(storage_keys)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        storage_keys: list of StorageKey objects</span>
<span class="sd">        block_hash: Optional block_hash of state snapshot</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of `(storage_key, scale_obj)` tuples</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="c1"># Retrieve corresponding value</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;state_queryStorageAt&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="n">s</span><span class="o">.</span><span class="n">to_hex</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">storage_keys</span><span class="p">],</span> <span class="n">block_hash</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">storage_key_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="o">.</span><span class="n">to_hex</span><span class="p">():</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">storage_keys</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">result_group</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">change_storage_key</span><span class="p">,</span> <span class="n">change_data</span> <span class="ow">in</span> <span class="n">result_group</span><span class="p">[</span><span class="s1">&#39;changes&#39;</span><span class="p">]:</span>
                <span class="c1"># Decode result for specified storage_key</span>
                <span class="n">storage_key</span> <span class="o">=</span> <span class="n">storage_key_map</span><span class="p">[</span><span class="n">change_storage_key</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">change_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">change_data</span> <span class="o">=</span> <span class="n">ScaleBytes</span><span class="p">(</span><span class="n">change_data</span><span class="p">)</span>

                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">storage_key</span><span class="p">,</span> <span class="n">storage_key</span><span class="o">.</span><span class="n">decode_scale_value</span><span class="p">(</span><span class="n">change_data</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="SubstrateInterface.query">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.query">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">storage_function</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
              <span class="n">subscription_handler</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">raw_storage_key</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScaleType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the storage entry for given module, function and optional parameters at given block hash.</span>

<span class="sd">        When a subscription_handler callback function is passed, a subscription will be maintained as long as this</span>
<span class="sd">        handler doesn&#39;t return a value.</span>

<span class="sd">        Example of subscription handler:</span>
<span class="sd">        ```</span>
<span class="sd">        def subscription_handler(obj, update_nr, subscription_id):</span>

<span class="sd">            if update_nr == 0:</span>
<span class="sd">                print(&#39;Initial data:&#39;, obj.value)</span>

<span class="sd">            if update_nr &gt; 0:</span>
<span class="sd">                # Do something with the update</span>
<span class="sd">                print(&#39;data changed:&#39;, obj.value)</span>

<span class="sd">            # The execution will block until an arbitrary value is returned, which will be the result of the `query`</span>
<span class="sd">            if update_nr &gt; 1:</span>
<span class="sd">                return obj</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module: The module name in the metadata, e.g. Balances or Account</span>
<span class="sd">        storage_function: The storage function name, e.g. FreeBalance or AccountNonce</span>
<span class="sd">        params: list of params, in the decoded format of the applicable ScaleTypes</span>
<span class="sd">        block_hash: Optional block hash, when omitted the chain tip will be used</span>
<span class="sd">        subscription_handler: Callback function that processes the updates of the storage query subscription</span>
<span class="sd">        raw_storage_key: Optional raw storage key to query decode instead of generating one</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ScaleType</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">block_hash</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Check requirements</span>
            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">subscription_handler</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Subscriptions can only be registered for current state; block_hash cannot be set&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Retrieve chain tip</span>
            <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chain_head</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;Substrate&#39;</span><span class="p">:</span>
            <span class="c1"># Search for &#39;well-known&#39; storage keys</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__query_well_known</span><span class="p">(</span><span class="n">storage_function</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">)</span>

        <span class="c1"># Search storage call in metadata</span>
        <span class="n">metadata_pallet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get_metadata_pallet</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">metadata_pallet</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">StorageFunctionNotFound</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pallet &quot;</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s1">&quot; not found&#39;</span><span class="p">)</span>

        <span class="n">storage_item</span> <span class="o">=</span> <span class="n">metadata_pallet</span><span class="o">.</span><span class="n">get_storage_function</span><span class="p">(</span><span class="n">storage_function</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">metadata_pallet</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">storage_item</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">StorageFunctionNotFound</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Storage function &quot;</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">storage_function</span><span class="si">}</span><span class="s1">&quot; not found&#39;</span><span class="p">)</span>

        <span class="c1"># SCALE type string of value</span>
        <span class="n">param_types</span> <span class="o">=</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">get_params_type_string</span><span class="p">()</span>
        <span class="n">value_scale_type</span> <span class="o">=</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">get_value_type_string</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Storage function requires </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">param_types</span><span class="p">)</span><span class="si">}</span><span class="s1"> parameters, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="si">}</span><span class="s1"> given&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">raw_storage_key</span><span class="p">:</span>
            <span class="n">storage_key</span> <span class="o">=</span> <span class="n">StorageKey</span><span class="o">.</span><span class="n">create_from_data</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">raw_storage_key</span><span class="p">,</span> <span class="n">pallet</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">storage_function</span><span class="o">=</span><span class="n">storage_function</span><span class="p">,</span>
                <span class="n">value_scale_type</span><span class="o">=</span><span class="n">value_scale_type</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="n">runtime_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="n">storage_key</span> <span class="o">=</span> <span class="n">StorageKey</span><span class="o">.</span><span class="n">create_from_storage_function</span><span class="p">(</span>
                <span class="n">module</span><span class="p">,</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="n">runtime_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">subscription_handler</span><span class="p">):</span>

            <span class="c1"># Wrap subscription handler to discard storage key arg</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">result_handler</span><span class="p">(</span><span class="n">storage_key</span><span class="p">,</span> <span class="n">updated_obj</span><span class="p">,</span> <span class="n">update_nr</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">subscription_handler</span><span class="p">(</span><span class="n">updated_obj</span><span class="p">,</span> <span class="n">update_nr</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subscribe_storage</span><span class="p">([</span><span class="n">storage_key</span><span class="p">],</span> <span class="n">result_handler</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">supports_rpc_method</span><span class="p">(</span><span class="s1">&#39;state_getStorageAt&#39;</span><span class="p">):</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;state_getStorageAt&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">storage_key</span><span class="o">.</span><span class="n">to_hex</span><span class="p">(),</span> <span class="n">block_hash</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;state_getStorage&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">storage_key</span><span class="o">.</span><span class="n">to_hex</span><span class="p">(),</span> <span class="n">block_hash</span><span class="p">])</span>

            <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="s1">&#39;result&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value_scale_type</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">query_value</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;modifier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Default&#39;</span><span class="p">:</span>
                        <span class="c1"># Fallback to default value of storage function if no result</span>
                        <span class="n">query_value</span> <span class="o">=</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">value_object</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_object</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># No result is interpreted as an Option&lt;...&gt; result</span>
                        <span class="n">value_scale_type</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Option&lt;</span><span class="si">{</span><span class="n">value_scale_type</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
                        <span class="n">query_value</span> <span class="o">=</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">value_object</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_object</span>

                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span>
                        <span class="n">type_string</span><span class="o">=</span><span class="n">value_scale_type</span><span class="p">,</span>
                        <span class="n">data</span><span class="o">=</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="n">query_value</span><span class="p">),</span>
                        <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
                    <span class="p">)</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">check_remaining</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_scale_decode&#39;</span><span class="p">))</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">meta_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;result_found&#39;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>

                    <span class="k">return</span> <span class="n">obj</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">__query_well_known</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScaleType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query well-known storage keys as defined in Substrate</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Optional[ScaleType]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">WELL_KNOWN_STORAGE_KEYS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">StorageFunctionNotFound</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Well known storage key for &quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot; not found&#39;</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_storage_by_key</span><span class="p">(</span><span class="n">block_hash</span><span class="p">,</span> <span class="n">WELL_KNOWN_STORAGE_KEYS</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;storage_key&#39;</span><span class="p">])</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span>
            <span class="n">WELL_KNOWN_STORAGE_KEYS</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;value_type_string&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="n">check_remaining</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_scale_decode&#39;</span><span class="p">))</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">meta_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;result_found&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">elif</span> <span class="n">WELL_KNOWN_STORAGE_KEYS</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;default&#39;</span><span class="p">]:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
                <span class="n">ScaleBytes</span><span class="p">(</span><span class="n">WELL_KNOWN_STORAGE_KEYS</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;default&#39;</span><span class="p">]),</span>
                <span class="n">check_remaining</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_scale_decode&#39;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">meta_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;result_found&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No value to decode&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="SubstrateInterface.create_storage_key">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.create_storage_key">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_storage_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pallet</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">storage_function</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StorageKey</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a `StorageKey` instance providing storage function details. See `subscribe_storage()`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pallet: name of pallet</span>
<span class="sd">        storage_function: name of storage function</span>
<span class="sd">        params: Optional list of parameters in case of a Mapped storage function</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        StorageKey</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">StorageKey</span><span class="o">.</span><span class="n">create_from_storage_function</span><span class="p">(</span>
            <span class="n">pallet</span><span class="p">,</span> <span class="n">storage_function</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">runtime_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.subscribe_storage">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.subscribe_storage">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">subscribe_storage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_keys</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">StorageKey</span><span class="p">],</span> <span class="n">subscription_handler</span><span class="p">:</span> <span class="nb">callable</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Subscribe to provided storage_keys and keep tracking until `subscription_handler` returns a value</span>

<span class="sd">        Example of a StorageKey:</span>
<span class="sd">        ```</span>
<span class="sd">        StorageKey.create_from_storage_function(</span>
<span class="sd">            &quot;System&quot;, &quot;Account&quot;, [&quot;5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY&quot;]</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>

<span class="sd">        Example of a subscription handler:</span>
<span class="sd">        ```</span>
<span class="sd">        def subscription_handler(storage_key, obj, update_nr, subscription_id):</span>

<span class="sd">            if update_nr == 0:</span>
<span class="sd">                print(&#39;Initial data:&#39;, storage_key, obj.value)</span>

<span class="sd">            if update_nr &gt; 0:</span>
<span class="sd">                # Do something with the update</span>
<span class="sd">                print(&#39;data changed:&#39;, storage_key, obj.value)</span>

<span class="sd">            # The execution will block until an arbitrary value is returned, which will be the result of the function</span>
<span class="sd">            if update_nr &gt; 1:</span>
<span class="sd">                return obj</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        storage_keys: StorageKey list of storage keys to subscribe to</span>
<span class="sd">        subscription_handler: callable to handle value changes of subscription</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">()</span>

        <span class="n">storage_key_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="o">.</span><span class="n">to_hex</span><span class="p">():</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">storage_keys</span><span class="p">}</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">result_handler</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">update_nr</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">):</span>
            <span class="c1"># Process changes</span>
            <span class="k">for</span> <span class="n">change_storage_key</span><span class="p">,</span> <span class="n">change_data</span> <span class="ow">in</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="s1">&#39;changes&#39;</span><span class="p">]:</span>
                <span class="c1"># Check for target storage key</span>
                <span class="n">storage_key</span> <span class="o">=</span> <span class="n">storage_key_map</span><span class="p">[</span><span class="n">change_storage_key</span><span class="p">]</span>
                <span class="n">result_found</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="k">if</span> <span class="n">change_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">change_scale_type</span> <span class="o">=</span> <span class="n">storage_key</span><span class="o">.</span><span class="n">value_scale_type</span>
                    <span class="n">result_found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">storage_key</span><span class="o">.</span><span class="n">metadata_storage_function</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;modifier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Default&#39;</span><span class="p">:</span>
                    <span class="c1"># Fallback to default value of storage function if no result</span>
                    <span class="n">change_scale_type</span> <span class="o">=</span> <span class="n">storage_key</span><span class="o">.</span><span class="n">value_scale_type</span>
                    <span class="n">change_data</span> <span class="o">=</span> <span class="n">storage_key</span><span class="o">.</span><span class="n">metadata_storage_function</span><span class="o">.</span><span class="n">value_object</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_object</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># No result is interpreted as an Option&lt;...&gt; result</span>
                    <span class="n">change_scale_type</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Option&lt;</span><span class="si">{</span><span class="n">storage_key</span><span class="o">.</span><span class="n">value_scale_type</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
                    <span class="n">change_data</span> <span class="o">=</span> <span class="n">storage_key</span><span class="o">.</span><span class="n">metadata_storage_function</span><span class="o">.</span><span class="n">value_object</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_object</span>

                <span class="c1"># Decode SCALE result data</span>
                <span class="n">updated_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span>
                    <span class="n">type_string</span><span class="o">=</span><span class="n">change_scale_type</span><span class="p">,</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="n">change_data</span><span class="p">),</span>
                    <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
                <span class="p">)</span>
                <span class="n">updated_obj</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">check_remaining</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_scale_decode&#39;</span><span class="p">))</span>
                <span class="n">updated_obj</span><span class="o">.</span><span class="n">meta_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;result_found&#39;</span><span class="p">:</span> <span class="n">result_found</span><span class="p">}</span>

                <span class="n">subscription_result</span> <span class="o">=</span> <span class="n">subscription_handler</span><span class="p">(</span><span class="n">storage_key</span><span class="p">,</span> <span class="n">updated_obj</span><span class="p">,</span> <span class="n">update_nr</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">subscription_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Handler returned end result: unsubscribe from further updates</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;state_unsubscribeStorage&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">subscription_id</span><span class="p">])</span>

                    <span class="k">return</span> <span class="n">subscription_result</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">subscription_handler</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Provided &quot;subscription_handler&quot; is not callable&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span>
            <span class="s2">&quot;state_subscribeStorage&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="n">s</span><span class="o">.</span><span class="n">to_hex</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">storage_keys</span><span class="p">]],</span> <span class="n">result_handler</span><span class="o">=</span><span class="n">result_handler</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.retrieve_pending_extrinsics">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.retrieve_pending_extrinsics">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">retrieve_pending_extrinsics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves and decodes pending extrinsics from the node&#39;s transaction pool</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of extrinsics</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">()</span>

        <span class="n">result_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;author_pendingExtrinsics&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="n">extrinsics</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">extrinsic_data</span> <span class="ow">in</span> <span class="n">result_data</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]:</span>
            <span class="n">extrinsic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="s1">&#39;Extrinsic&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
            <span class="n">extrinsic</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="n">extrinsic_data</span><span class="p">),</span> <span class="n">check_remaining</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_scale_decode&#39;</span><span class="p">))</span>
            <span class="n">extrinsics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">extrinsic</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">extrinsics</span></div>


<div class="viewcode-block" id="SubstrateInterface.runtime_call">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.runtime_call">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">runtime_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScaleType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls a runtime API method</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        api: Name of the runtime API e.g. &#39;TransactionPaymentApi&#39;</span>
<span class="sd">        method: Name of the method e.g. &#39;query_fee_details&#39;</span>
<span class="sd">        params: List of parameters needed to call the runtime API</span>
<span class="sd">        block_hash: Hash of the block at which to make the runtime API call</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ScaleType</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Executing Runtime Call </span><span class="si">{</span><span class="n">api</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">runtime_call_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">type_registry</span><span class="p">[</span><span class="s2">&quot;runtime_api&quot;</span><span class="p">][</span><span class="n">api</span><span class="p">][</span><span class="s1">&#39;methods&#39;</span><span class="p">][</span><span class="n">method</span><span class="p">]</span>
            <span class="n">runtime_api_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">type_registry</span><span class="p">[</span><span class="s2">&quot;runtime_api&quot;</span><span class="p">][</span><span class="n">api</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;types&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime API Call &#39;</span><span class="si">{</span><span class="n">api</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39; not found in registry&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">runtime_call_def</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of parameter provided (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="si">}</span><span class="s2">) does not &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;match definition </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">runtime_call_def</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Add runtime API types to registry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">update_type_registry_types</span><span class="p">(</span><span class="n">runtime_api_types</span><span class="p">)</span>

        <span class="c1"># Encode params</span>
        <span class="n">param_data</span> <span class="o">=</span> <span class="n">ScaleBytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">runtime_call_def</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]):</span>
            <span class="n">scale_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">param_data</span> <span class="o">+=</span> <span class="n">scale_obj</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime Call param &#39;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; is missing&quot;</span><span class="p">)</span>

                <span class="n">param_data</span> <span class="o">+=</span> <span class="n">scale_obj</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]])</span>

        <span class="c1"># RPC request</span>
        <span class="n">result_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;state_call&quot;</span><span class="p">,</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">api</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">param_data</span><span class="p">),</span> <span class="n">block_hash</span><span class="p">])</span>

        <span class="c1"># Decode result</span>
        <span class="n">result_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="n">runtime_call_def</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
        <span class="n">result_obj</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="n">result_data</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]),</span> <span class="n">check_remaining</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_scale_decode&#39;</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">result_obj</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_events">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_events">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to get events for a certain block (storage call for module &#39;System&#39; and function &#39;Events&#39;)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">events</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">block_hash</span><span class="p">:</span>
            <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chain_head</span><span class="p">()</span>

        <span class="n">storage_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="s2">&quot;System&quot;</span><span class="p">,</span> <span class="n">storage_function</span><span class="o">=</span><span class="s2">&quot;Events&quot;</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">storage_obj</span><span class="p">:</span>
            <span class="n">events</span> <span class="o">+=</span> <span class="n">storage_obj</span><span class="o">.</span><span class="n">elements</span>
        <span class="k">return</span> <span class="n">events</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `MetadataVersioned` object for given block_hash or chaintip if block_hash is omitted</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MetadataVersioned</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_runtime_metadata">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_runtime_metadata">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_runtime_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves and decodes the metadata for given block or chaintip if block_hash is omitted.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;get_runtime_metadata() will be removed in future releases&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">block_hash</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">block_hash</span><span class="p">]</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;state_getMetadata&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;error&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;result&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
            <span class="n">metadata_decoder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span>
                <span class="s1">&#39;MetadataVersioned&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)))</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata_decoder</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">response</span></div>


<div class="viewcode-block" id="SubstrateInterface.create_scale_object">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.create_scale_object">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_scale_object</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">type_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">ScaleBytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ScaleType&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to create a SCALE object of type `type_string`, this will initialize the runtime</span>
<span class="sd">        automatically at moment of `block_hash`, or chain tip if omitted.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        type_string: str Name of SCALE type to create</span>
<span class="sd">        data: ScaleBytes Optional ScaleBytes to decode</span>
<span class="sd">        block_hash: Optional block hash for moment of decoding, when omitted the chain tip will be used</span>
<span class="sd">        kwargs</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ScaleType</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;metadata&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="n">type_string</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.compose_call">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.compose_call">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compose_call</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">call_module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">call_function</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">call_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GenericCall</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Composes a call payload which can be used in an extrinsic.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        call_module: Name of the runtime module e.g. Balances</span>
<span class="sd">        call_function: Name of the call function e.g. transfer</span>
<span class="sd">        call_params: This is a dict containing the params of the call. e.g. `{&#39;dest&#39;: &#39;EaG2CRhJWPb7qmdcJvy3LiWdh26Jreu9Dx6R1rXxPmYXoDk&#39;, &#39;value&#39;: 1000000000000}`</span>
<span class="sd">        block_hash: Use metadata at given block_hash to compose call</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GenericCall</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">call_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">call_params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="n">call</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span>
            <span class="n">type_string</span><span class="o">=</span><span class="s1">&#39;Call&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
        <span class="p">)</span>

        <span class="n">call</span><span class="o">.</span><span class="n">encode</span><span class="p">({</span>
            <span class="s1">&#39;call_module&#39;</span><span class="p">:</span> <span class="n">call_module</span><span class="p">,</span>
            <span class="s1">&#39;call_function&#39;</span><span class="p">:</span> <span class="n">call_function</span><span class="p">,</span>
            <span class="s1">&#39;call_args&#39;</span><span class="p">:</span> <span class="n">call_params</span>
        <span class="p">})</span>

        <span class="k">return</span> <span class="n">call</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_account_nonce">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_account_nonce">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_account_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns current nonce for given account address</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        account_address: SS58 formatted address</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">supports_rpc_method</span><span class="p">(</span><span class="s1">&#39;state_call&#39;</span><span class="p">):</span>
            <span class="n">nonce_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_call</span><span class="p">(</span><span class="s2">&quot;AccountNonceApi&quot;</span><span class="p">,</span> <span class="s2">&quot;account_nonce&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">account_address</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">nonce_obj</span><span class="o">.</span><span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;system_accountNextIndex&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">account_address</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.generate_signature_payload">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.generate_signature_payload">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_signature_payload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="n">GenericCall</span><span class="p">,</span> <span class="n">era</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nonce</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tip</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                   <span class="n">tip_asset_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">include_call_length</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScaleBytes</span><span class="p">:</span>

        <span class="c1"># Retrieve genesis hash</span>
        <span class="n">genesis_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_block_hash</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">era</span><span class="p">:</span>
            <span class="n">era</span> <span class="o">=</span> <span class="s1">&#39;00&#39;</span>

        <span class="k">if</span> <span class="n">era</span> <span class="o">==</span> <span class="s1">&#39;00&#39;</span><span class="p">:</span>
            <span class="c1"># Immortal extrinsic</span>
            <span class="n">block_hash</span> <span class="o">=</span> <span class="n">genesis_hash</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Determine mortality of extrinsic</span>
            <span class="n">era_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="s1">&#39;Era&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">era</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;current&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">era</span> <span class="ow">and</span> <span class="s1">&#39;phase&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">era</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The era dict must contain either &quot;current&quot; or &quot;phase&quot; element to encode a valid era&#39;</span><span class="p">)</span>

            <span class="n">era_obj</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">era</span><span class="p">)</span>
            <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_block_hash</span><span class="p">(</span><span class="n">block_id</span><span class="o">=</span><span class="n">era_obj</span><span class="o">.</span><span class="n">birth</span><span class="p">(</span><span class="n">era</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;current&#39;</span><span class="p">)))</span>

        <span class="c1"># Create signature payload</span>
        <span class="n">signature_payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="s1">&#39;ExtrinsicPayloadValue&#39;</span><span class="p">)</span>

        <span class="c1"># Process signed extensions in metadata</span>
        <span class="k">if</span> <span class="s1">&#39;signed_extensions&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;extrinsic&#39;</span><span class="p">]:</span>

            <span class="c1"># Base signature payload</span>
            <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;call&#39;</span><span class="p">,</span> <span class="s1">&#39;CallBytes&#39;</span><span class="p">]]</span>

            <span class="c1"># Add signed extensions to payload</span>
            <span class="n">signed_extensions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get_signed_extensions</span><span class="p">()</span>

            <span class="k">if</span> <span class="s1">&#39;CheckMortality&#39;</span> <span class="ow">in</span> <span class="n">signed_extensions</span><span class="p">:</span>
                <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">,</span> <span class="n">signed_extensions</span><span class="p">[</span><span class="s1">&#39;CheckMortality&#39;</span><span class="p">][</span><span class="s1">&#39;extrinsic&#39;</span><span class="p">]]</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;CheckEra&#39;</span> <span class="ow">in</span> <span class="n">signed_extensions</span><span class="p">:</span>
                <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">,</span> <span class="n">signed_extensions</span><span class="p">[</span><span class="s1">&#39;CheckEra&#39;</span><span class="p">][</span><span class="s1">&#39;extrinsic&#39;</span><span class="p">]]</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;CheckNonce&#39;</span> <span class="ow">in</span> <span class="n">signed_extensions</span><span class="p">:</span>
                <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="s1">&#39;nonce&#39;</span><span class="p">,</span> <span class="n">signed_extensions</span><span class="p">[</span><span class="s1">&#39;CheckNonce&#39;</span><span class="p">][</span><span class="s1">&#39;extrinsic&#39;</span><span class="p">]]</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;ChargeTransactionPayment&#39;</span> <span class="ow">in</span> <span class="n">signed_extensions</span><span class="p">:</span>
                <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="n">signed_extensions</span><span class="p">[</span><span class="s1">&#39;ChargeTransactionPayment&#39;</span><span class="p">][</span><span class="s1">&#39;extrinsic&#39;</span><span class="p">]]</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;ChargeAssetTxPayment&#39;</span> <span class="ow">in</span> <span class="n">signed_extensions</span><span class="p">:</span>
                <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="s1">&#39;asset_id&#39;</span><span class="p">,</span> <span class="n">signed_extensions</span><span class="p">[</span><span class="s1">&#39;ChargeAssetTxPayment&#39;</span><span class="p">][</span><span class="s1">&#39;extrinsic&#39;</span><span class="p">]]</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;CheckMetadataHash&#39;</span> <span class="ow">in</span> <span class="n">signed_extensions</span><span class="p">:</span>
                <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">,</span> <span class="n">signed_extensions</span><span class="p">[</span><span class="s1">&#39;CheckMetadataHash&#39;</span><span class="p">][</span><span class="s1">&#39;extrinsic&#39;</span><span class="p">]]</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;CheckSpecVersion&#39;</span> <span class="ow">in</span> <span class="n">signed_extensions</span><span class="p">:</span>
                <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="s1">&#39;spec_version&#39;</span><span class="p">,</span> <span class="n">signed_extensions</span><span class="p">[</span><span class="s1">&#39;CheckSpecVersion&#39;</span><span class="p">][</span><span class="s1">&#39;additional_signed&#39;</span><span class="p">]]</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;CheckTxVersion&#39;</span> <span class="ow">in</span> <span class="n">signed_extensions</span><span class="p">:</span>
                <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="s1">&#39;transaction_version&#39;</span><span class="p">,</span> <span class="n">signed_extensions</span><span class="p">[</span><span class="s1">&#39;CheckTxVersion&#39;</span><span class="p">][</span><span class="s1">&#39;additional_signed&#39;</span><span class="p">]]</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;CheckGenesis&#39;</span> <span class="ow">in</span> <span class="n">signed_extensions</span><span class="p">:</span>
                <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="s1">&#39;genesis_hash&#39;</span><span class="p">,</span> <span class="n">signed_extensions</span><span class="p">[</span><span class="s1">&#39;CheckGenesis&#39;</span><span class="p">][</span><span class="s1">&#39;additional_signed&#39;</span><span class="p">]]</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;CheckMortality&#39;</span> <span class="ow">in</span> <span class="n">signed_extensions</span><span class="p">:</span>
                <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="s1">&#39;block_hash&#39;</span><span class="p">,</span> <span class="n">signed_extensions</span><span class="p">[</span><span class="s1">&#39;CheckMortality&#39;</span><span class="p">][</span><span class="s1">&#39;additional_signed&#39;</span><span class="p">]]</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;CheckEra&#39;</span> <span class="ow">in</span> <span class="n">signed_extensions</span><span class="p">:</span>
                <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="s1">&#39;block_hash&#39;</span><span class="p">,</span> <span class="n">signed_extensions</span><span class="p">[</span><span class="s1">&#39;CheckEra&#39;</span><span class="p">][</span><span class="s1">&#39;additional_signed&#39;</span><span class="p">]]</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;CheckMetadataHash&#39;</span> <span class="ow">in</span> <span class="n">signed_extensions</span><span class="p">:</span>
                <span class="n">signature_payload</span><span class="o">.</span><span class="n">type_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="s1">&#39;metadata_hash&#39;</span><span class="p">,</span> <span class="n">signed_extensions</span><span class="p">[</span><span class="s1">&#39;CheckMetadataHash&#39;</span><span class="p">][</span><span class="s1">&#39;additional_signed&#39;</span><span class="p">]]</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">include_call_length</span><span class="p">:</span>

            <span class="n">length_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="s1">&#39;Bytes&#39;</span><span class="p">)</span>
            <span class="n">call_data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">length_obj</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">call_data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="n">payload_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;call&#39;</span><span class="p">:</span> <span class="n">call_data</span><span class="p">,</span>
            <span class="s1">&#39;era&#39;</span><span class="p">:</span> <span class="n">era</span><span class="p">,</span>
            <span class="s1">&#39;nonce&#39;</span><span class="p">:</span> <span class="n">nonce</span><span class="p">,</span>
            <span class="s1">&#39;tip&#39;</span><span class="p">:</span> <span class="n">tip</span><span class="p">,</span>
            <span class="s1">&#39;spec_version&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">,</span>
            <span class="s1">&#39;genesis_hash&#39;</span><span class="p">:</span> <span class="n">genesis_hash</span><span class="p">,</span>
            <span class="s1">&#39;block_hash&#39;</span><span class="p">:</span> <span class="n">block_hash</span><span class="p">,</span>
            <span class="s1">&#39;transaction_version&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">transaction_version</span><span class="p">,</span>
            <span class="s1">&#39;asset_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;tip&#39;</span><span class="p">:</span> <span class="n">tip</span><span class="p">,</span> <span class="s1">&#39;asset_id&#39;</span><span class="p">:</span> <span class="n">tip_asset_id</span><span class="p">},</span>
            <span class="s1">&#39;metadata_hash&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;Disabled&#39;</span>
        <span class="p">}</span>

        <span class="n">signature_payload</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">payload_dict</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">signature_payload</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">256</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ScaleBytes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">blake2b</span><span class="p">(</span><span class="n">signature_payload</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">digest_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">signature_payload</span><span class="o">.</span><span class="n">data</span></div>


<div class="viewcode-block" id="SubstrateInterface.create_signed_extrinsic">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.create_signed_extrinsic">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_signed_extrinsic</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="n">GenericCall</span><span class="p">,</span> <span class="n">keypair</span><span class="p">:</span> <span class="n">Keypair</span><span class="p">,</span> <span class="n">era</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">nonce</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">tip</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tip_asset_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">signature</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GenericExtrinsic</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an extrinsic signed by given account details</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        call: GenericCall to create extrinsic for</span>
<span class="sd">        keypair: Keypair used to sign the extrinsic</span>
<span class="sd">        era: Specify mortality in blocks in follow format: {&#39;period&#39;: [amount_blocks]} If omitted the extrinsic is immortal</span>
<span class="sd">        nonce: nonce to include in extrinsics, if omitted the current nonce is retrieved on-chain</span>
<span class="sd">        tip: The tip for the block author to gain priority during network congestion</span>
<span class="sd">        tip_asset_id: Optional asset ID with which to pay the tip</span>
<span class="sd">        signature: Optionally provide signature if externally signed</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GenericExtrinsic The signed Extrinsic</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">()</span>

        <span class="c1"># Check requirements</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">call</span><span class="p">,</span> <span class="n">GenericCall</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;call&#39; must be of type Call&quot;</span><span class="p">)</span>

        <span class="c1"># Check if extrinsic version is supported</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;extrinsic&#39;</span><span class="p">][</span><span class="s1">&#39;version&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Extrinsic version </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;extrinsic&#39;</span><span class="p">][</span><span class="s1">&#39;version&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> not supported&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Retrieve nonce</span>
        <span class="k">if</span> <span class="n">nonce</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nonce</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_account_nonce</span><span class="p">(</span><span class="n">keypair</span><span class="o">.</span><span class="n">ss58_address</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>

        <span class="c1"># Process era</span>
        <span class="k">if</span> <span class="n">era</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">era</span> <span class="o">=</span> <span class="s1">&#39;00&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">era</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;current&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">era</span> <span class="ow">and</span> <span class="s1">&#39;phase&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">era</span><span class="p">:</span>
                <span class="c1"># Retrieve current block id</span>
                <span class="n">era</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_block_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_chain_finalised_head</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">signature</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">and</span> <span class="n">signature</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0x&#39;</span><span class="p">:</span>
                <span class="n">signature</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">signature</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>

            <span class="c1"># Check if signature is a MultiSignature and contains signature version</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span> <span class="o">==</span> <span class="mi">65</span><span class="p">:</span>
                <span class="n">signature_version</span> <span class="o">=</span> <span class="n">signature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">signature</span> <span class="o">=</span> <span class="n">signature</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">signature_version</span> <span class="o">=</span> <span class="n">keypair</span><span class="o">.</span><span class="n">crypto_type</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Create signature payload</span>
            <span class="n">signature_payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_signature_payload</span><span class="p">(</span>
                <span class="n">call</span><span class="o">=</span><span class="n">call</span><span class="p">,</span> <span class="n">era</span><span class="o">=</span><span class="n">era</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">,</span> <span class="n">tip</span><span class="o">=</span><span class="n">tip</span><span class="p">,</span> <span class="n">tip_asset_id</span><span class="o">=</span><span class="n">tip_asset_id</span>
            <span class="p">)</span>

            <span class="c1"># Set Signature version to crypto type of keypair</span>
            <span class="n">signature_version</span> <span class="o">=</span> <span class="n">keypair</span><span class="o">.</span><span class="n">crypto_type</span>

            <span class="c1"># Sign payload</span>
            <span class="n">signature</span> <span class="o">=</span> <span class="n">keypair</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">signature_payload</span><span class="p">)</span>

        <span class="c1"># Create extrinsic</span>
        <span class="n">extrinsic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="n">type_string</span><span class="o">=</span><span class="s1">&#39;Extrinsic&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>

        <span class="n">value</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;account_id&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;0x</span><span class="si">{</span><span class="n">keypair</span><span class="o">.</span><span class="n">public_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;signature&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;0x</span><span class="si">{</span><span class="n">signature</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;call_function&#39;</span><span class="p">:</span> <span class="n">call</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;call_function&#39;</span><span class="p">],</span>
            <span class="s1">&#39;call_module&#39;</span><span class="p">:</span> <span class="n">call</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;call_module&#39;</span><span class="p">],</span>
            <span class="s1">&#39;call_args&#39;</span><span class="p">:</span> <span class="n">call</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;call_args&#39;</span><span class="p">],</span>
            <span class="s1">&#39;nonce&#39;</span><span class="p">:</span> <span class="n">nonce</span><span class="p">,</span>
            <span class="s1">&#39;era&#39;</span><span class="p">:</span> <span class="n">era</span><span class="p">,</span>
            <span class="s1">&#39;tip&#39;</span><span class="p">:</span> <span class="n">tip</span><span class="p">,</span>
            <span class="s1">&#39;asset_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;tip&#39;</span><span class="p">:</span> <span class="n">tip</span><span class="p">,</span> <span class="s1">&#39;asset_id&#39;</span><span class="p">:</span> <span class="n">tip_asset_id</span><span class="p">},</span>
            <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;Disabled&#39;</span>
        <span class="p">}</span>

        <span class="c1"># Check if ExtrinsicSignature is MultiSignature, otherwise omit signature_version</span>
        <span class="n">signature_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">get_decoder_class</span><span class="p">(</span><span class="s2">&quot;ExtrinsicSignature&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">signature_cls</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">get_decoder_class</span><span class="p">(</span><span class="s1">&#39;Enum&#39;</span><span class="p">)):</span>
            <span class="n">value</span><span class="p">[</span><span class="s1">&#39;signature_version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">signature_version</span>

        <span class="n">extrinsic</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">extrinsic</span></div>


<div class="viewcode-block" id="SubstrateInterface.create_unsigned_extrinsic">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.create_unsigned_extrinsic">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_unsigned_extrinsic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="n">GenericCall</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GenericExtrinsic</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create unsigned extrinsic for given `Call`</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        call: GenericCall the call the extrinsic should contain</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GenericExtrinsic</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">()</span>

        <span class="c1"># Create extrinsic</span>
        <span class="n">extrinsic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="n">type_string</span><span class="o">=</span><span class="s1">&#39;Extrinsic&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>

        <span class="n">extrinsic</span><span class="o">.</span><span class="n">encode</span><span class="p">({</span>
            <span class="s1">&#39;call_function&#39;</span><span class="p">:</span> <span class="n">call</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;call_function&#39;</span><span class="p">],</span>
            <span class="s1">&#39;call_module&#39;</span><span class="p">:</span> <span class="n">call</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;call_module&#39;</span><span class="p">],</span>
            <span class="s1">&#39;call_args&#39;</span><span class="p">:</span> <span class="n">call</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;call_args&#39;</span><span class="p">]</span>
        <span class="p">})</span>

        <span class="k">return</span> <span class="n">extrinsic</span></div>


<div class="viewcode-block" id="SubstrateInterface.generate_multisig_account">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.generate_multisig_account">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_multisig_account</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signatories</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MultiAccountId</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate deterministic Multisig account with supplied signatories and threshold</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        signatories: List of signatories</span>
<span class="sd">        threshold: Amount of approvals needed to execute</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MultiAccountId</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">multi_sig_account</span> <span class="o">=</span> <span class="n">MultiAccountId</span><span class="o">.</span><span class="n">create_from_account_list</span><span class="p">(</span><span class="n">signatories</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>

        <span class="n">multi_sig_account</span><span class="o">.</span><span class="n">ss58_address</span> <span class="o">=</span> <span class="n">ss58_encode</span><span class="p">(</span><span class="n">multi_sig_account</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss58_format</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">multi_sig_account</span></div>


<div class="viewcode-block" id="SubstrateInterface.create_multisig_extrinsic">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.create_multisig_extrinsic">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_multisig_extrinsic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="n">GenericCall</span><span class="p">,</span> <span class="n">keypair</span><span class="p">:</span> <span class="n">Keypair</span><span class="p">,</span> <span class="n">multisig_account</span><span class="p">:</span> <span class="n">MultiAccountId</span><span class="p">,</span>
                                  <span class="n">max_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">era</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">nonce</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">tip</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tip_asset_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">signature</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GenericExtrinsic</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a Multisig extrinsic that will be signed by one of the signatories. Checks on-chain if the threshold</span>
<span class="sd">        of the multisig account is reached and try to execute the call accordingly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        call: GenericCall to create extrinsic for</span>
<span class="sd">        keypair: Keypair of the signatory to approve given call</span>
<span class="sd">        multisig_account: MultiAccountId to use of origin of the extrinsic (see `generate_multisig_account()`)</span>
<span class="sd">        max_weight: Maximum allowed weight to execute the call ( Uses `get_payment_info()` by default)</span>
<span class="sd">        era: Specify mortality in blocks in follow format: {&#39;period&#39;: [amount_blocks]} If omitted the extrinsic is immortal</span>
<span class="sd">        nonce: nonce to include in extrinsics, if omitted the current nonce is retrieved on-chain</span>
<span class="sd">        tip: The tip for the block author to gain priority during network congestion</span>
<span class="sd">        tip_asset_id: Optional asset ID with which to pay the tip</span>
<span class="sd">        signature: Optionally provide signature if externally signed</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GenericExtrinsic</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">max_weight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">payment_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_payment_info</span><span class="p">(</span><span class="n">call</span><span class="p">,</span> <span class="n">keypair</span><span class="p">)</span>
            <span class="n">max_weight</span> <span class="o">=</span> <span class="n">payment_info</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>

        <span class="c1"># Check if call has existing approvals</span>
        <span class="n">multisig_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Multisig&quot;</span><span class="p">,</span> <span class="s2">&quot;Multisigs&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">multisig_account</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">call</span><span class="o">.</span><span class="n">call_hash</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">multisig_details</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">maybe_timepoint</span> <span class="o">=</span> <span class="n">multisig_details</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;when&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">maybe_timepoint</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Compose &#39;as_multi&#39; when final, &#39;approve_as_multi&#39; otherwise</span>
        <span class="k">if</span> <span class="n">multisig_details</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">multisig_details</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;approvals&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">multisig_account</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
            <span class="n">multi_sig_call</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compose_call</span><span class="p">(</span><span class="s2">&quot;Multisig&quot;</span><span class="p">,</span> <span class="s2">&quot;as_multi&quot;</span><span class="p">,</span> <span class="p">{</span>
                <span class="s1">&#39;other_signatories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">multisig_account</span><span class="o">.</span><span class="n">signatories</span> <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="sa">f</span><span class="s1">&#39;0x</span><span class="si">{</span><span class="n">keypair</span><span class="o">.</span><span class="n">public_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span>
                <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="n">multisig_account</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span>
                <span class="s1">&#39;maybe_timepoint&#39;</span><span class="p">:</span> <span class="n">maybe_timepoint</span><span class="p">,</span>
                <span class="s1">&#39;call&#39;</span><span class="p">:</span> <span class="n">call</span><span class="p">,</span>
                <span class="s1">&#39;store_call&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;max_weight&#39;</span><span class="p">:</span> <span class="n">max_weight</span>
            <span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">multi_sig_call</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compose_call</span><span class="p">(</span><span class="s2">&quot;Multisig&quot;</span><span class="p">,</span> <span class="s2">&quot;approve_as_multi&quot;</span><span class="p">,</span> <span class="p">{</span>
                <span class="s1">&#39;other_signatories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">multisig_account</span><span class="o">.</span><span class="n">signatories</span> <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="sa">f</span><span class="s1">&#39;0x</span><span class="si">{</span><span class="n">keypair</span><span class="o">.</span><span class="n">public_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span>
                <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="n">multisig_account</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span>
                <span class="s1">&#39;maybe_timepoint&#39;</span><span class="p">:</span> <span class="n">maybe_timepoint</span><span class="p">,</span>
                <span class="s1">&#39;call_hash&#39;</span><span class="p">:</span> <span class="n">call</span><span class="o">.</span><span class="n">call_hash</span><span class="p">,</span>
                <span class="s1">&#39;max_weight&#39;</span><span class="p">:</span> <span class="n">max_weight</span>
            <span class="p">})</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_signed_extrinsic</span><span class="p">(</span>
            <span class="n">multi_sig_call</span><span class="p">,</span> <span class="n">keypair</span><span class="p">,</span> <span class="n">era</span><span class="o">=</span><span class="n">era</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">,</span> <span class="n">tip</span><span class="o">=</span><span class="n">tip</span><span class="p">,</span> <span class="n">tip_asset_id</span><span class="o">=</span><span class="n">tip_asset_id</span><span class="p">,</span> <span class="n">signature</span><span class="o">=</span><span class="n">signature</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.submit_extrinsic">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.submit_extrinsic">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">submit_extrinsic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extrinsic</span><span class="p">:</span> <span class="n">GenericExtrinsic</span><span class="p">,</span> <span class="n">wait_for_inclusion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                         <span class="n">wait_for_finalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExtrinsicReceipt&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Submit an extrinsic to the connected node, with the possibility to wait until the extrinsic is included</span>
<span class="sd">         in a block and/or the block is finalized. The receipt returned provided information about the block and</span>
<span class="sd">         triggered events</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        extrinsic: Extrinsic The extrinsic to be sent to the network</span>
<span class="sd">        wait_for_inclusion: wait until extrinsic is included in a block (only works for websocket connections)</span>
<span class="sd">        wait_for_finalization: wait until extrinsic is finalized (only works for websocket connections)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ExtrinsicReceipt</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check requirements</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extrinsic</span><span class="p">,</span> <span class="n">GenericExtrinsic</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;extrinsic&#39; must be of type Extrinsics&quot;</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">result_handler</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">update_nr</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">):</span>
            <span class="c1"># Check if extrinsic is included and finalized</span>
            <span class="k">if</span> <span class="s1">&#39;params&#39;</span> <span class="ow">in</span> <span class="n">message</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">message</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;result&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>

                <span class="c1"># Convert result enum to lower for backwards compatibility</span>
                <span class="n">message_result</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;result&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

                <span class="k">if</span> <span class="s1">&#39;finalized&#39;</span> <span class="ow">in</span> <span class="n">message_result</span> <span class="ow">and</span> <span class="n">wait_for_finalization</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s1">&#39;author_unwatchExtrinsic&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">subscription_id</span><span class="p">])</span>
                    <span class="k">return</span> <span class="p">{</span>
                        <span class="s1">&#39;block_hash&#39;</span><span class="p">:</span> <span class="n">message_result</span><span class="p">[</span><span class="s1">&#39;finalized&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;extrinsic_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">extrinsic</span><span class="o">.</span><span class="n">extrinsic_hash</span><span class="o">.</span><span class="n">hex</span><span class="p">()),</span>
                        <span class="s1">&#39;finalized&#39;</span><span class="p">:</span> <span class="kc">True</span>
                    <span class="p">}</span>
                <span class="k">elif</span> <span class="s1">&#39;inblock&#39;</span> <span class="ow">in</span> <span class="n">message_result</span> <span class="ow">and</span> <span class="n">wait_for_inclusion</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">wait_for_finalization</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s1">&#39;author_unwatchExtrinsic&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">subscription_id</span><span class="p">])</span>
                    <span class="k">return</span> <span class="p">{</span>
                        <span class="s1">&#39;block_hash&#39;</span><span class="p">:</span> <span class="n">message_result</span><span class="p">[</span><span class="s1">&#39;inblock&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;extrinsic_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">extrinsic</span><span class="o">.</span><span class="n">extrinsic_hash</span><span class="o">.</span><span class="n">hex</span><span class="p">()),</span>
                        <span class="s1">&#39;finalized&#39;</span><span class="p">:</span> <span class="kc">False</span>
                    <span class="p">}</span>

        <span class="k">if</span> <span class="n">wait_for_inclusion</span> <span class="ow">or</span> <span class="n">wait_for_finalization</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span>
                <span class="s2">&quot;author_submitAndWatchExtrinsic&quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">extrinsic</span><span class="o">.</span><span class="n">data</span><span class="p">)],</span>
                <span class="n">result_handler</span><span class="o">=</span><span class="n">result_handler</span>
            <span class="p">)</span>

            <span class="n">result</span> <span class="o">=</span> <span class="n">ExtrinsicReceipt</span><span class="p">(</span>
                <span class="n">substrate</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">extrinsic_hash</span><span class="o">=</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;extrinsic_hash&#39;</span><span class="p">],</span>
                <span class="n">block_hash</span><span class="o">=</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;block_hash&#39;</span><span class="p">],</span>
                <span class="n">finalized</span><span class="o">=</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;finalized&#39;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s2">&quot;author_submitExtrinsic&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">extrinsic</span><span class="o">.</span><span class="n">data</span><span class="p">)])</span>

            <span class="k">if</span> <span class="s1">&#39;result&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">))</span>

            <span class="n">result</span> <span class="o">=</span> <span class="n">ExtrinsicReceipt</span><span class="p">(</span>
                <span class="n">substrate</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">extrinsic_hash</span><span class="o">=</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_payment_info">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_payment_info">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_payment_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="n">GenericCall</span><span class="p">,</span> <span class="n">keypair</span><span class="p">:</span> <span class="n">Keypair</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves fee estimation via RPC for given extrinsic</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        call: Call object to estimate fees for</span>
<span class="sd">        keypair: Keypair of the sender, does not have to include private key because no valid signature is required</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dict with payment info</span>

<span class="sd">        E.g. `{&#39;class&#39;: &#39;normal&#39;, &#39;partialFee&#39;: 151000000, &#39;weight&#39;: {&#39;ref_time&#39;: 143322000}}`</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check requirements</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">call</span><span class="p">,</span> <span class="n">GenericCall</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;call&#39; must be of type Call&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keypair</span><span class="p">,</span> <span class="n">Keypair</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;keypair&#39; must be of type Keypair&quot;</span><span class="p">)</span>

        <span class="c1"># No valid signature is required for fee estimation</span>
        <span class="n">signature</span> <span class="o">=</span> <span class="s1">&#39;0x&#39;</span> <span class="o">+</span> <span class="s1">&#39;00&#39;</span> <span class="o">*</span> <span class="mi">64</span>

        <span class="c1"># Create extrinsic</span>
        <span class="n">extrinsic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_signed_extrinsic</span><span class="p">(</span>
            <span class="n">call</span><span class="o">=</span><span class="n">call</span><span class="p">,</span>
            <span class="n">keypair</span><span class="o">=</span><span class="n">keypair</span><span class="p">,</span>
            <span class="n">signature</span><span class="o">=</span><span class="n">signature</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">supports_rpc_method</span><span class="p">(</span><span class="s1">&#39;state_call&#39;</span><span class="p">):</span>
            <span class="n">extrinsic_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="s1">&#39;u32&#39;</span><span class="p">)</span>
            <span class="n">extrinsic_len</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">extrinsic</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>

            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_call</span><span class="p">(</span><span class="s2">&quot;TransactionPaymentApi&quot;</span><span class="p">,</span> <span class="s2">&quot;query_info&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">extrinsic</span><span class="p">,</span> <span class="n">extrinsic_len</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Backwards compatibility; deprecated RPC method</span>
            <span class="n">payment_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s1">&#39;payment_queryInfo&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">extrinsic</span><span class="o">.</span><span class="n">data</span><span class="p">)])</span>

            <span class="c1"># convert partialFee to int</span>
            <span class="k">if</span> <span class="s1">&#39;result&#39;</span> <span class="ow">in</span> <span class="n">payment_info</span><span class="p">:</span>
                <span class="n">payment_info</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="s1">&#39;partialFee&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">payment_info</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="s1">&#39;partialFee&#39;</span><span class="p">])</span>

                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">payment_info</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
                    <span class="c1"># Transform format to WeightV2 if applicable as per https://github.com/paritytech/substrate/pull/12633</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">weight_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="s2">&quot;sp_weights::weight_v2::Weight&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">weight_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">payment_info</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                                <span class="s1">&#39;ref_time&#39;</span><span class="p">:</span> <span class="n">payment_info</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span>
                                <span class="s1">&#39;proof_size&#39;</span><span class="p">:</span> <span class="mi">0</span>
                            <span class="p">}</span>
                    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
                        <span class="k">pass</span>

                <span class="k">return</span> <span class="n">payment_info</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SubstrateRequestException</span><span class="p">(</span><span class="n">payment_info</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">])</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_type_registry">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_type_registry">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_type_registry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_recursion</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates an exhaustive list of which RUST types exist in the runtime specified at given block_hash (or</span>
<span class="sd">        chaintip if block_hash is omitted)</span>

<span class="sd">        MetadataV14 or higher is required.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash: Chaintip will be used if block_hash is omitted</span>
<span class="sd">        max_recursion: Increasing recursion will provide more detail but also has impact on performance</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">implements_scaleinfo</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;MetadataV14 or higher runtimes is required&quot;</span><span class="p">)</span>

        <span class="n">type_registry</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">scale_info_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">portable_registry</span><span class="p">[</span><span class="s1">&#39;types&#39;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="s1">&#39;path&#39;</span> <span class="ow">in</span> <span class="n">scale_info_type</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">scale_info_type</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">][</span><span class="s1">&#39;path&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">type_string</span> <span class="o">=</span> <span class="s1">&#39;::&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scale_info_type</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">][</span><span class="s2">&quot;path&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">type_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;scale_info::</span><span class="si">{</span><span class="n">scale_info_type</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>

            <span class="n">scale_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">get_decoder_class</span><span class="p">(</span><span class="n">type_string</span><span class="p">)</span>
            <span class="n">type_registry</span><span class="p">[</span><span class="n">type_string</span><span class="p">]</span> <span class="o">=</span> <span class="n">scale_cls</span><span class="o">.</span><span class="n">generate_type_decomposition</span><span class="p">(</span>
                <span class="n">max_recursion</span><span class="o">=</span><span class="n">max_recursion</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">type_registry</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_type_definition">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_type_definition">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_type_definition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves SCALE encoding specifications of given type_string</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        type_string: RUST variable type, e.g. Vec&lt;Address&gt; or scale_info::0</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scale_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="n">type_string</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">scale_obj</span><span class="o">.</span><span class="n">generate_type_decomposition</span><span class="p">()</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_modules">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_modules">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list of modules in metadata for given block_hash (or chaintip if block_hash is omitted)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[{</span>
            <span class="s1">&#39;metadata_index&#39;</span><span class="p">:</span> <span class="n">idx</span><span class="p">,</span>
            <span class="s1">&#39;module_id&#39;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(),</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;spec_version&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">,</span>
            <span class="s1">&#39;count_call_functions&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">calls</span> <span class="ow">or</span> <span class="p">[]),</span>
            <span class="s1">&#39;count_storage_functions&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">storage</span> <span class="ow">or</span> <span class="p">[]),</span>
            <span class="s1">&#39;count_events&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">events</span> <span class="ow">or</span> <span class="p">[]),</span>
            <span class="s1">&#39;count_constants&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">constants</span> <span class="ow">or</span> <span class="p">[]),</span>
            <span class="s1">&#39;count_errors&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">errors</span> <span class="ow">or</span> <span class="p">[]),</span>
        <span class="p">}</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">module</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">pallets</span><span class="p">)]</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_module">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_module">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves modules in metadata by name for given block_hash (or chaintip if block_hash is omitted)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MetadataModule</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get_metadata_pallet</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_call_functions">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_call_functions">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_call_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list of all call functions in metadata active for given block_hash (or chaintip if block_hash is omitted)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="n">call_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">pallet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">pallets</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pallet</span><span class="o">.</span><span class="n">calls</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">pallet</span><span class="o">.</span><span class="n">calls</span><span class="p">:</span>

                    <span class="n">call_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_module_call</span><span class="p">(</span>
                            <span class="n">pallet</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="n">call_list</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_call_function">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_call_function">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_call_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">call_function_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the details of a call function given module name, call function name and block_hash</span>
<span class="sd">        (or chaintip if block_hash is omitted)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module_name</span>
<span class="sd">        call_function_name</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">pallet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">pallets</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pallet</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">module_name</span> <span class="ow">and</span> <span class="n">pallet</span><span class="o">.</span><span class="n">calls</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">pallet</span><span class="o">.</span><span class="n">calls</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">call</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">call_function_name</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">call</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_events">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_events">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list of all events in metadata active for given block_hash (or chaintip if block_hash is omitted)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="n">event_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">event_index</span><span class="p">,</span> <span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">event_index</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">event_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">serialize_module_event</span><span class="p">(</span>
                    <span class="n">module</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span><span class="p">,</span> <span class="n">event_index</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">event_list</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_event">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_event">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">event_name</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the details of an event for given module name, call function name and block_hash</span>
<span class="sd">        (or chaintip if block_hash is omitted)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module_name</span>
<span class="sd">        event_name</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">pallet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">pallets</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pallet</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">module_name</span> <span class="ow">and</span> <span class="n">pallet</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pallet</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">event_name</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">event</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_constants">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_constants">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list of all constants in metadata active at given block_hash (or chaintip if block_hash is omitted)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="n">constant_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">module_idx</span><span class="p">,</span> <span class="n">module</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">pallets</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">constant</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">constants</span> <span class="ow">or</span> <span class="p">[]:</span>
                <span class="n">constant_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">serialize_constant</span><span class="p">(</span>
                        <span class="n">constant</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span>
                    <span class="p">)</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">constant_list</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_constant">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_constant">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">constant_name</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the details of a constant for given module name, call function name and block_hash</span>
<span class="sd">        (or chaintip if block_hash is omitted)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module_name</span>
<span class="sd">        constant_name</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MetadataModuleConstants</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">module_idx</span><span class="p">,</span> <span class="n">module</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">pallets</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">module_name</span> <span class="o">==</span> <span class="n">module</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="n">module</span><span class="o">.</span><span class="n">constants</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">constant</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">constants</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">constant_name</span> <span class="o">==</span> <span class="n">constant</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
                        <span class="k">return</span> <span class="n">constant</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_constant">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_constant">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">constant_name</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ScaleType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the decoded `ScaleType` object of the constant for given module name, call function name and block_hash</span>
<span class="sd">        (or chaintip if block_hash is omitted)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module_name</span>
<span class="sd">        constant_name</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ScaleType</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">constant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata_constant</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">constant_name</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">constant</span><span class="p">:</span>
            <span class="c1"># Decode to ScaleType</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_scale</span><span class="p">(</span>
                <span class="n">constant</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">ScaleBytes</span><span class="p">(</span><span class="n">constant</span><span class="o">.</span><span class="n">constant_value</span><span class="p">),</span> <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">,</span> <span class="n">return_scale_obj</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_storage_functions">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_storage_functions">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_storage_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list of all storage functions in metadata active at given block_hash (or chaintip if block_hash is</span>
<span class="sd">        omitted)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="n">storage_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">module_idx</span><span class="p">,</span> <span class="n">module</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">pallets</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">storage</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">storage</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">storage</span><span class="p">:</span>
                    <span class="n">storage_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_storage_item</span><span class="p">(</span>
                            <span class="n">storage_item</span><span class="o">=</span><span class="n">storage</span><span class="p">,</span>
                            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
                            <span class="n">spec_version_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="n">storage_list</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_storage_function">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_storage_function">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_storage_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">storage_name</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the details of a storage function for given module name, call function name and block_hash</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module_name</span>
<span class="sd">        storage_name</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="n">pallet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get_metadata_pallet</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pallet</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pallet</span><span class="o">.</span><span class="n">get_storage_function</span><span class="p">(</span><span class="n">storage_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_errors">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_errors">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list of all errors in metadata active at given block_hash (or chaintip if block_hash is omitted)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="n">error_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">module_idx</span><span class="p">,</span> <span class="n">module</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">pallets</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
                    <span class="n">error_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">serialize_module_error</span><span class="p">(</span>
                            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">spec_version</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_version</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="n">error_list</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_error">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_error">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">error_name</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the details of an error for given module name, call function name and block_hash</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module_name</span>
<span class="sd">        error_name</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">module_idx</span><span class="p">,</span> <span class="n">module</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">pallets</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">module_name</span> <span class="ow">and</span> <span class="n">module</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">error_name</span> <span class="o">==</span> <span class="n">error</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">error</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_runtime_call_functions">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_runtime_call_functions">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_runtime_call_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a list of available runtime API calls</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">()</span>
        <span class="n">call_functions</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">api</span><span class="p">,</span> <span class="n">methods</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">type_registry</span><span class="p">[</span><span class="s2">&quot;runtime_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">[</span><span class="s2">&quot;methods&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">call_functions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata_runtime_call_function</span><span class="p">(</span><span class="n">api</span><span class="p">,</span> <span class="n">method</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">call_functions</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_metadata_runtime_call_function">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_metadata_runtime_call_function">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_runtime_call_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GenericRuntimeCallDefinition</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get details of a runtime API call</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        api: Name of the runtime API e.g. &#39;TransactionPaymentApi&#39;</span>
<span class="sd">        method: Name of the method e.g. &#39;query_fee_details&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GenericRuntimeCallDefinition</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">runtime_call_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">type_registry</span><span class="p">[</span><span class="s2">&quot;runtime_api&quot;</span><span class="p">][</span><span class="n">api</span><span class="p">][</span><span class="s1">&#39;methods&#39;</span><span class="p">][</span><span class="n">method</span><span class="p">]</span>
            <span class="n">runtime_call_def</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">api</span>
            <span class="n">runtime_call_def</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">method</span>
            <span class="n">runtime_api_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">type_registry</span><span class="p">[</span><span class="s2">&quot;runtime_api&quot;</span><span class="p">][</span><span class="n">api</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;types&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime API Call &#39;</span><span class="si">{</span><span class="n">api</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39; not found in registry&quot;</span><span class="p">)</span>

        <span class="c1"># Add runtime API types to registry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">update_type_registry_types</span><span class="p">(</span><span class="n">runtime_api_types</span><span class="p">)</span>

        <span class="n">runtime_call_def_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span><span class="s2">&quot;RuntimeCallDefinition&quot;</span><span class="p">)</span>
        <span class="n">runtime_call_def_obj</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">runtime_call_def</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">runtime_call_def_obj</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">__get_block_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ignore_decoding_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">include_author</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">header_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">finalized_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">subscription_handler</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">BlockNotFound</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">decode_block</span><span class="p">(</span><span class="n">block_data</span><span class="p">,</span> <span class="n">block_data_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">block_data</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">block_data_hash</span><span class="p">:</span>
                    <span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s1">&#39;hash&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">block_data_hash</span>

                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s1">&#39;number&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="c1"># Convert block number from hex (backwards compatibility)</span>
                    <span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s1">&#39;number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s1">&#39;number&#39;</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>

                <span class="n">extrinsic_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">get_decoder_class</span><span class="p">(</span><span class="s1">&#39;Extrinsic&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="s1">&#39;extrinsics&#39;</span> <span class="ow">in</span> <span class="n">block_data</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">extrinsic_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;extrinsics&#39;</span><span class="p">]):</span>
                        <span class="n">extrinsic_decoder</span> <span class="o">=</span> <span class="n">extrinsic_cls</span><span class="p">(</span>
                            <span class="n">data</span><span class="o">=</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="n">extrinsic_data</span><span class="p">),</span>
                            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
                            <span class="n">runtime_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span>
                        <span class="p">)</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">extrinsic_decoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">check_remaining</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_scale_decode&#39;</span><span class="p">))</span>
                            <span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;extrinsics&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">extrinsic_decoder</span>

                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_decoding_errors</span><span class="p">:</span>
                                <span class="k">raise</span>
                            <span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;extrinsics&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">log_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s2">&quot;digest&quot;</span><span class="p">][</span><span class="s2">&quot;logs&quot;</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">log_data</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                        <span class="c1"># Convert digest log from hex (backwards compatibility)</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">log_digest_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">get_decoder_class</span><span class="p">(</span><span class="s1">&#39;sp_runtime::generic::digest::DigestItem&#39;</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">log_digest_cls</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;No decoding class found for &#39;DigestItem&#39;&quot;</span><span class="p">)</span>

                            <span class="n">log_digest</span> <span class="o">=</span> <span class="n">log_digest_cls</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="n">log_data</span><span class="p">))</span>
                            <span class="n">log_digest</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">check_remaining</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_scale_decode&#39;</span><span class="p">))</span>

                            <span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s2">&quot;digest&quot;</span><span class="p">][</span><span class="s2">&quot;logs&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_digest</span>

                            <span class="k">if</span> <span class="n">include_author</span> <span class="ow">and</span> <span class="s1">&#39;PreRuntime&#39;</span> <span class="ow">in</span> <span class="n">log_digest</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>

                                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">implements_scaleinfo</span><span class="p">():</span>

                                    <span class="n">engine</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">log_digest</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                                    <span class="c1"># Retrieve validator set</span>
                                    <span class="n">parent_hash</span> <span class="o">=</span> <span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s1">&#39;parentHash&#39;</span><span class="p">]</span>
                                    <span class="n">validator_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Session&quot;</span><span class="p">,</span> <span class="s2">&quot;Validators&quot;</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="n">parent_hash</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="n">engine</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;BABE&#39;</span><span class="p">:</span>
                                        <span class="n">babe_predigest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span>
                                            <span class="n">type_string</span><span class="o">=</span><span class="s1">&#39;RawBabePreDigest&#39;</span><span class="p">,</span>
                                            <span class="n">data</span><span class="o">=</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">log_digest</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
                                        <span class="p">)</span>

                                        <span class="n">babe_predigest</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">check_remaining</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_scale_decode&#39;</span><span class="p">))</span>

                                        <span class="n">rank_validator</span> <span class="o">=</span> <span class="n">babe_predigest</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;authority_index&#39;</span><span class="p">]</span>

                                        <span class="n">block_author</span> <span class="o">=</span> <span class="n">validator_set</span><span class="p">[</span><span class="n">rank_validator</span><span class="p">]</span>
                                        <span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">block_author</span><span class="o">.</span><span class="n">value</span>

                                    <span class="k">elif</span> <span class="n">engine</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;aura&#39;</span><span class="p">:</span>
                                        <span class="n">aura_predigest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span>
                                            <span class="n">type_string</span><span class="o">=</span><span class="s1">&#39;RawAuraPreDigest&#39;</span><span class="p">,</span>
                                            <span class="n">data</span><span class="o">=</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">log_digest</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
                                        <span class="p">)</span>

                                        <span class="n">aura_predigest</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">check_remaining</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_scale_decode&#39;</span><span class="p">))</span>

                                        <span class="n">rank_validator</span> <span class="o">=</span> <span class="n">aura_predigest</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;slot_number&#39;</span><span class="p">]</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">validator_set</span><span class="p">)</span>

                                        <span class="n">block_author</span> <span class="o">=</span> <span class="n">validator_set</span><span class="p">[</span><span class="n">rank_validator</span><span class="p">]</span>
                                        <span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">block_author</span><span class="o">.</span><span class="n">value</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                                            <span class="sa">f</span><span class="s2">&quot;Cannot extract author for engine </span><span class="si">{</span><span class="n">log_digest</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;PreRuntime&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                                        <span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>

                                    <span class="k">if</span> <span class="n">log_digest</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;PreRuntime&#39;</span><span class="p">][</span><span class="s1">&#39;engine&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;BABE&#39;</span><span class="p">:</span>
                                        <span class="n">validator_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Session&quot;</span><span class="p">,</span> <span class="s2">&quot;Validators&quot;</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>
                                        <span class="n">rank_validator</span> <span class="o">=</span> <span class="n">log_digest</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;PreRuntime&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="s1">&#39;authority_index&#39;</span><span class="p">]</span>

                                        <span class="n">block_author</span> <span class="o">=</span> <span class="n">validator_set</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">rank_validator</span><span class="p">]</span>
                                        <span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">block_author</span><span class="o">.</span><span class="n">value</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                                            <span class="sa">f</span><span class="s2">&quot;Cannot extract author for engine </span><span class="si">{</span><span class="n">log_digest</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;PreRuntime&#39;</span><span class="p">][</span><span class="s1">&#39;engine&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                                        <span class="p">)</span>

                        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_decoding_errors</span><span class="p">:</span>
                                <span class="k">raise</span>
                            <span class="n">block_data</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s2">&quot;digest&quot;</span><span class="p">][</span><span class="s2">&quot;logs&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">return</span> <span class="n">block_data</span>

        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">subscription_handler</span><span class="p">):</span>

            <span class="n">rpc_method_prefix</span> <span class="o">=</span> <span class="s1">&#39;Finalized&#39;</span> <span class="k">if</span> <span class="n">finalized_only</span> <span class="k">else</span> <span class="s1">&#39;New&#39;</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">result_handler</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">update_nr</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">):</span>

                <span class="n">new_block</span> <span class="o">=</span> <span class="n">decode_block</span><span class="p">({</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;result&#39;</span><span class="p">]})</span>

                <span class="n">subscription_result</span> <span class="o">=</span> <span class="n">subscription_handler</span><span class="p">(</span><span class="n">new_block</span><span class="p">,</span> <span class="n">update_nr</span><span class="p">,</span> <span class="n">subscription_id</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">subscription_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Handler returned end result: unsubscribe from further updates</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;chain_unsubscribe</span><span class="si">{</span><span class="n">rpc_method_prefix</span><span class="si">}</span><span class="s2">Heads&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">subscription_id</span><span class="p">])</span>

                <span class="k">return</span> <span class="n">subscription_result</span>

            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;chain_subscribe</span><span class="si">{</span><span class="n">rpc_method_prefix</span><span class="si">}</span><span class="s2">Heads&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">result_handler</span><span class="o">=</span><span class="n">result_handler</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">result</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">header_only</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s1">&#39;chain_getHeader&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">block_hash</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">decode_block</span><span class="p">({</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]},</span> <span class="n">block_data_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc_request</span><span class="p">(</span><span class="s1">&#39;chain_getBlock&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">block_hash</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">decode_block</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="s1">&#39;block&#39;</span><span class="p">],</span> <span class="n">block_data_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

<div class="viewcode-block" id="SubstrateInterface.get_block">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_block">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">block_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ignore_decoding_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">include_author</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">finalized_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a block and decodes its containing extrinsics and log digest items. If `block_hash` and `block_number`</span>
<span class="sd">        is omited the chain tip will be retrieve, or the finalized head if `finalized_only` is set to true.</span>

<span class="sd">        Either `block_hash` or `block_number` should be set, or both omitted.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash: the hash of the block to be retrieved</span>
<span class="sd">        block_number: the block number to retrieved</span>
<span class="sd">        ignore_decoding_errors: When set this will catch all decoding errors, set the item to None and continue decoding</span>
<span class="sd">        include_author: This will retrieve the block author from the validator set and add to the result</span>
<span class="sd">        finalized_only: when no `block_hash` or `block_number` is set, this will retrieve the finalized head</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A dict containing the extrinsic and digest logs data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">block_hash</span> <span class="ow">and</span> <span class="n">block_number</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Either block_hash or block_number should be be set&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">block_number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_block_hash</span><span class="p">(</span><span class="n">block_number</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">block_hash</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span>

        <span class="k">if</span> <span class="n">block_hash</span> <span class="ow">and</span> <span class="n">finalized_only</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;finalized_only cannot be True when block_hash is provided&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">block_hash</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Retrieve block hash</span>
            <span class="k">if</span> <span class="n">finalized_only</span><span class="p">:</span>
                <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chain_finalised_head</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chain_head</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_block_handler</span><span class="p">(</span>
            <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">,</span> <span class="n">ignore_decoding_errors</span><span class="o">=</span><span class="n">ignore_decoding_errors</span><span class="p">,</span> <span class="n">header_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">include_author</span><span class="o">=</span><span class="n">include_author</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_block_header">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_block_header">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_block_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">block_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ignore_decoding_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                         <span class="n">include_author</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">finalized_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a block header and decodes its containing log digest items. If `block_hash` and `block_number`</span>
<span class="sd">        is omited the chain tip will be retrieve, or the finalized head if `finalized_only` is set to true.</span>

<span class="sd">        Either `block_hash` or `block_number` should be set, or both omitted.</span>

<span class="sd">        See `get_block()` to also include the extrinsics in the result</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash: the hash of the block to be retrieved</span>
<span class="sd">        block_number: the block number to retrieved</span>
<span class="sd">        ignore_decoding_errors: When set this will catch all decoding errors, set the item to None and continue decoding</span>
<span class="sd">        include_author: This will retrieve the block author from the validator set and add to the result</span>
<span class="sd">        finalized_only: when no `block_hash` or `block_number` is set, this will retrieve the finalized head</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A dict containing the header and digest logs data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">block_hash</span> <span class="ow">and</span> <span class="n">block_number</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Either block_hash or block_number should be be set&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">block_number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_block_hash</span><span class="p">(</span><span class="n">block_number</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">block_hash</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span>

        <span class="k">if</span> <span class="n">block_hash</span> <span class="ow">and</span> <span class="n">finalized_only</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;finalized_only cannot be True when block_hash is provided&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">block_hash</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Retrieve block hash</span>
            <span class="k">if</span> <span class="n">finalized_only</span><span class="p">:</span>
                <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chain_finalised_head</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chain_head</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Check conflicting scenarios</span>
            <span class="k">if</span> <span class="n">finalized_only</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;finalized_only cannot be True when block_hash is provided&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_block_handler</span><span class="p">(</span>
            <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">,</span> <span class="n">ignore_decoding_errors</span><span class="o">=</span><span class="n">ignore_decoding_errors</span><span class="p">,</span> <span class="n">header_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">include_author</span><span class="o">=</span><span class="n">include_author</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.subscribe_block_headers">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.subscribe_block_headers">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">subscribe_block_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subscription_handler</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">ignore_decoding_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                <span class="n">include_author</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">finalized_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Subscribe to new block headers as soon as they are available. The callable `subscription_handler` will be</span>
<span class="sd">        executed when a new block is available and execution will block until `subscription_handler` will return</span>
<span class="sd">        a result other than `None`.</span>

<span class="sd">        Example:</span>

<span class="sd">        ```</span>
<span class="sd">        def subscription_handler(obj, update_nr, subscription_id):</span>

<span class="sd">            print(f&quot;New block #{obj[&#39;header&#39;][&#39;number&#39;]} produced by {obj[&#39;header&#39;][&#39;author&#39;]}&quot;)</span>

<span class="sd">            if update_nr &gt; 10</span>
<span class="sd">              return {&#39;message&#39;: &#39;Subscription will cancel when a value is returned&#39;, &#39;updates_processed&#39;: update_nr}</span>


<span class="sd">        result = substrate.subscribe_block_headers(subscription_handler, include_author=True)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        subscription_handler</span>
<span class="sd">        ignore_decoding_errors: When set this will catch all decoding errors, set the item to None and continue decoding</span>
<span class="sd">        include_author: This will retrieve the block author from the validator set and add to the result</span>
<span class="sd">        finalized_only: when no `block_hash` or `block_number` is set, this will retrieve the finalized head</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Value return by `subscription_handler`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Retrieve block hash</span>
        <span class="k">if</span> <span class="n">finalized_only</span><span class="p">:</span>
            <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chain_finalised_head</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">block_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chain_head</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_block_handler</span><span class="p">(</span>
            <span class="n">block_hash</span><span class="p">,</span> <span class="n">subscription_handler</span><span class="o">=</span><span class="n">subscription_handler</span><span class="p">,</span> <span class="n">ignore_decoding_errors</span><span class="o">=</span><span class="n">ignore_decoding_errors</span><span class="p">,</span>
            <span class="n">include_author</span><span class="o">=</span><span class="n">include_author</span><span class="p">,</span> <span class="n">finalized_only</span><span class="o">=</span><span class="n">finalized_only</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.retrieve_extrinsic_by_identifier">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.retrieve_extrinsic_by_identifier">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">retrieve_extrinsic_by_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extrinsic_identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExtrinsicReceipt&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve an extrinsic by its identifier in format &quot;[block_number]-[extrinsic_index]&quot; e.g. 333456-4</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        extrinsic_identifier</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ExtrinsicReceipt</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ExtrinsicReceipt</span><span class="o">.</span><span class="n">create_from_extrinsic_identifier</span><span class="p">(</span>
            <span class="n">substrate</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">extrinsic_identifier</span><span class="o">=</span><span class="n">extrinsic_identifier</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.retrieve_extrinsic_by_hash">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.retrieve_extrinsic_by_hash">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">retrieve_extrinsic_by_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">extrinsic_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExtrinsicReceipt&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve an extrinsic by providing the block_hash and the extrinsic hash</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>
<span class="sd">        extrinsic_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ExtrinsicReceipt</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ExtrinsicReceipt</span><span class="p">(</span>
            <span class="n">substrate</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">,</span>
            <span class="n">extrinsic_hash</span><span class="o">=</span><span class="n">extrinsic_hash</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_extrinsics">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_extrinsics">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_extrinsics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">block_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return extrinsics for given block_hash or block_number</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        block_hash</span>
<span class="sd">        block_number</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">block</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_block</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">,</span> <span class="n">block_number</span><span class="o">=</span><span class="n">block_number</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">block</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">block</span><span class="p">[</span><span class="s1">&#39;extrinsics&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="SubstrateInterface.extension_call">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.extension_call">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">extension_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extension</span><span class="p">,</span> <span class="n">Extension</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">extension</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Call &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; using extension </span><span class="si">{</span><span class="n">extension</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> ...&quot;</span><span class="p">)</span>
                        <span class="n">results</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">extension</span><span class="p">,</span> <span class="n">name</span><span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">results</span>
                    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
                        <span class="k">pass</span>

        <span class="k">raise</span> <span class="n">ExtensionCallNotFound</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No extension found that implements &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.filter_extrinsics">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.filter_extrinsics">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter_extrinsics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extension_call</span><span class="p">(</span><span class="s1">&#39;filter_extrinsics&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.filter_events">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.filter_events">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extension_call</span><span class="p">(</span><span class="s1">&#39;filter_events&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.search_block_number">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.search_block_number">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">search_block_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_datetime</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">block_time</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extension_call</span><span class="p">(</span><span class="s1">&#39;search_block_number&#39;</span><span class="p">,</span> <span class="n">block_datetime</span><span class="o">=</span><span class="n">block_datetime</span><span class="p">,</span> <span class="n">block_time</span><span class="o">=</span><span class="n">block_time</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.get_block_timestamp">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.get_block_timestamp">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_block_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extension_call</span><span class="p">(</span><span class="s1">&#39;get_block_timestamp&#39;</span><span class="p">,</span> <span class="n">block_number</span><span class="o">=</span><span class="n">block_number</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.decode_scale">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.decode_scale">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">decode_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_string</span><span class="p">,</span> <span class="n">scale_bytes</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_scale_obj</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to decode arbitrary SCALE-bytes (e.g. 0x02000000) according to given RUST type_string</span>
<span class="sd">        (e.g. BlockNumber). The relevant versioning information of the type (if defined) will be applied if block_hash</span>
<span class="sd">        is set</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        type_string</span>
<span class="sd">        scale_bytes</span>
<span class="sd">        block_hash</span>
<span class="sd">        return_scale_obj: if True the SCALE object itself is returned, otherwise the serialized dict value of the object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">scale_bytes</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">scale_bytes</span> <span class="o">=</span> <span class="n">ScaleBytes</span><span class="p">(</span><span class="n">scale_bytes</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span>
            <span class="n">type_string</span><span class="o">=</span><span class="n">type_string</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">scale_bytes</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
        <span class="p">)</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">check_remaining</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_scale_decode&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">return_scale_obj</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">value</span></div>


<div class="viewcode-block" id="SubstrateInterface.encode_scale">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.encode_scale">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">encode_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_string</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScaleBytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to encode arbitrary data into SCALE-bytes for given RUST type_string</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        type_string</span>
<span class="sd">        value</span>
<span class="sd">        block_hash</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ScaleBytes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_runtime</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span>
            <span class="n">type_string</span><span class="o">=</span><span class="n">type_string</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.ss58_encode">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.ss58_encode">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ss58_encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">public_key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span> <span class="n">ss58_format</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to encode a public key to SS58 address.</span>

<span class="sd">        If no target `ss58_format` is provided, it will default to the ss58 format of the network it&#39;s connected to.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        public_key: 32 bytes or hex-string. e.g. 0x6e39f36c370dd51d9a7594846914035de7ea8de466778ea4be6c036df8151f29</span>
<span class="sd">        ss58_format: target networkID to format the address for, defaults to the network it&#39;s connected to</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str containing the SS58 address</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ss58_format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ss58_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss58_format</span>

        <span class="k">return</span> <span class="n">ss58_encode</span><span class="p">(</span><span class="n">public_key</span><span class="p">,</span> <span class="n">ss58_format</span><span class="o">=</span><span class="n">ss58_format</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.ss58_decode">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.ss58_decode">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ss58_decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ss58_address</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to decode a SS58 address to a public key</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ss58_address</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str containing the hex representation of the public key</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ss58_decode</span><span class="p">(</span><span class="n">ss58_address</span><span class="p">,</span> <span class="n">valid_ss58_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ss58_format</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.is_valid_ss58_address">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.is_valid_ss58_address">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_valid_ss58_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to validate given value as ss58_address for current network/ss58_format</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">is_valid_ss58_address</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">valid_ss58_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ss58_format</span><span class="p">)</span></div>


    <span class="c1"># Serializing helper function</span>

<div class="viewcode-block" id="SubstrateInterface.serialize_storage_item">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.serialize_storage_item">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">serialize_storage_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_item</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">spec_version_id</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to serialize a storage item</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        storage_item</span>
<span class="sd">        module</span>
<span class="sd">        spec_version_id</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">storage_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;storage_name&quot;</span><span class="p">:</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;storage_modifier&quot;</span><span class="p">:</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">modifier</span><span class="p">,</span>
            <span class="s2">&quot;storage_default_scale&quot;</span><span class="p">:</span> <span class="n">storage_item</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_used_bytes</span><span class="p">(),</span>
            <span class="s2">&quot;storage_default&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;documentation&quot;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_item</span><span class="o">.</span><span class="n">docs</span><span class="p">),</span>
            <span class="s2">&quot;module_id&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(),</span>
            <span class="s2">&quot;module_prefix&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;storage&#39;</span><span class="p">][</span><span class="s1">&#39;prefix&#39;</span><span class="p">],</span>
            <span class="s2">&quot;module_name&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;spec_version&quot;</span><span class="p">:</span> <span class="n">spec_version_id</span><span class="p">,</span>
            <span class="s2">&quot;type_keys&quot;</span><span class="p">:</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">get_params_type_string</span><span class="p">(),</span>
            <span class="s2">&quot;type_hashers&quot;</span><span class="p">:</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">get_param_hashers</span><span class="p">(),</span>
            <span class="s2">&quot;type_value&quot;</span><span class="p">:</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">get_value_type_string</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="n">type_class</span><span class="p">,</span> <span class="n">type_info</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">storage_item</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

        <span class="n">storage_dict</span><span class="p">[</span><span class="s2">&quot;type_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_class</span>

        <span class="n">value_scale_type</span> <span class="o">=</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">get_value_type_string</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;modifier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Default&#39;</span><span class="p">:</span>
            <span class="c1"># Fallback to default value of storage function if no result</span>
            <span class="n">query_value</span> <span class="o">=</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">value_object</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_object</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No result is interpreted as an Option&lt;...&gt; result</span>
            <span class="n">value_scale_type</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Option&lt;</span><span class="si">{</span><span class="n">value_scale_type</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
            <span class="n">query_value</span> <span class="o">=</span> <span class="n">storage_item</span><span class="o">.</span><span class="n">value_object</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_object</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span>
                <span class="n">type_string</span><span class="o">=</span><span class="n">value_scale_type</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="n">query_value</span><span class="p">),</span>
                <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
            <span class="p">)</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
            <span class="n">storage_dict</span><span class="p">[</span><span class="s2">&quot;storage_default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">storage_dict</span><span class="p">[</span><span class="s2">&quot;storage_default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;[decoding error]&#39;</span>

        <span class="k">return</span> <span class="n">storage_dict</span></div>


<div class="viewcode-block" id="SubstrateInterface.serialize_constant">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.serialize_constant">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">serialize_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constant</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">spec_version_id</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to serialize a constant</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        constant</span>
<span class="sd">        module</span>
<span class="sd">        spec_version_id</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">value_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">create_scale_object</span><span class="p">(</span>
                <span class="n">type_string</span><span class="o">=</span><span class="n">constant</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ScaleBytes</span><span class="p">(</span><span class="n">constant</span><span class="o">.</span><span class="n">constant_value</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">constant_decoded_value</span> <span class="o">=</span> <span class="n">value_obj</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">constant_decoded_value</span> <span class="o">=</span> <span class="s1">&#39;[decoding error]&#39;</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;constant_name&quot;</span><span class="p">:</span> <span class="n">constant</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;constant_type&quot;</span><span class="p">:</span> <span class="n">constant</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
            <span class="s2">&quot;constant_value&quot;</span><span class="p">:</span> <span class="n">constant_decoded_value</span><span class="p">,</span>
            <span class="s2">&quot;constant_value_scale&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;0x</span><span class="si">{</span><span class="n">constant</span><span class="o">.</span><span class="n">constant_value</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;documentation&quot;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">constant</span><span class="o">.</span><span class="n">docs</span><span class="p">),</span>
            <span class="s2">&quot;module_id&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(),</span>
            <span class="s2">&quot;module_prefix&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;storage&#39;</span><span class="p">][</span><span class="s1">&#39;prefix&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;storage&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;module_name&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;spec_version&quot;</span><span class="p">:</span> <span class="n">spec_version_id</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="SubstrateInterface.serialize_module_call">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.serialize_module_call">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">serialize_module_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">spec_version</span><span class="p">,</span> <span class="n">call_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to serialize a call function</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module</span>
<span class="sd">        call</span>
<span class="sd">        spec_version</span>
<span class="sd">        call_index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="c1"># &quot;call_id&quot;: call.get_identifier(),</span>
            <span class="s2">&quot;call_name&quot;</span><span class="p">:</span> <span class="n">call</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;call_args&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">call_arg</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">call_arg</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">args</span><span class="p">],</span>
            <span class="c1"># &quot;lookup&quot;: &#39;0x{}&#39;.format(call_index),</span>
            <span class="s2">&quot;documentation&quot;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">docs</span><span class="p">),</span>
            <span class="c1"># &quot;module_id&quot;: module.get_identifier(),</span>
            <span class="s2">&quot;module_prefix&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;storage&#39;</span><span class="p">][</span><span class="s1">&#39;prefix&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;storage&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;module_name&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;spec_version&quot;</span><span class="p">:</span> <span class="n">spec_version</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="SubstrateInterface.serialize_module_event">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.serialize_module_event">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">serialize_module_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">spec_version</span><span class="p">,</span> <span class="n">event_index</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to serialize an event</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module</span>
<span class="sd">        event</span>
<span class="sd">        spec_version</span>
<span class="sd">        event_index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;event_id&quot;</span><span class="p">:</span> <span class="n">event</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;event_name&quot;</span><span class="p">:</span> <span class="n">event</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;event_args&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;event_arg_index&quot;</span><span class="p">:</span> <span class="n">idx</span><span class="p">,</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">arg</span>
                <span class="p">}</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="s2">&quot;lookup&quot;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">event_index</span><span class="p">),</span>
            <span class="s2">&quot;documentation&quot;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">docs</span><span class="p">),</span>
            <span class="s2">&quot;module_id&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(),</span>
            <span class="s2">&quot;module_prefix&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span>
            <span class="s2">&quot;module_name&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;spec_version&quot;</span><span class="p">:</span> <span class="n">spec_version</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="SubstrateInterface.serialize_module_error">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.serialize_module_error">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">serialize_module_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">spec_version</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to serialize an error</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module</span>
<span class="sd">        error</span>
<span class="sd">        spec_version</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;error_name&quot;</span><span class="p">:</span> <span class="n">error</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;documentation&quot;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">docs</span><span class="p">),</span>
            <span class="s2">&quot;module_id&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(),</span>
            <span class="s2">&quot;module_prefix&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;storage&#39;</span><span class="p">][</span><span class="s1">&#39;prefix&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;storage&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;module_name&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;spec_version&quot;</span><span class="p">:</span> <span class="n">spec_version</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="SubstrateInterface.update_type_registry_presets">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.update_type_registry_presets">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_type_registry_presets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">update_type_registries</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reload_type_registry</span><span class="p">(</span><span class="n">use_remote_preset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="SubstrateInterface.reload_type_registry">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.reload_type_registry">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reload_type_registry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_remote_preset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">auto_discover</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reload type registry and preset used to instantiate the SubtrateInterface object. Useful to periodically apply</span>
<span class="sd">        changes in type definitions when a runtime upgrade occurred</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        use_remote_preset: When True preset is downloaded from Github master, otherwise use files from local installed scalecodec package</span>
<span class="sd">        auto_discover</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">clear_type_registry</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">implements_scale_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">implements_scaleinfo</span><span class="p">()</span>

        <span class="c1"># Load metadata types in runtime configuration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">update_type_registry</span><span class="p">(</span><span class="n">load_type_registry_preset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;core&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apply_type_registry_presets</span><span class="p">(</span><span class="n">use_remote_preset</span><span class="o">=</span><span class="n">use_remote_preset</span><span class="p">,</span> <span class="n">auto_discover</span><span class="o">=</span><span class="n">auto_discover</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.apply_type_registry_presets">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.apply_type_registry_presets">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">apply_type_registry_presets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_remote_preset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">auto_discover</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_registry_preset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Load type registry according to preset</span>
            <span class="n">type_registry_preset_dict</span> <span class="o">=</span> <span class="n">load_type_registry_preset</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_registry_preset</span><span class="p">,</span> <span class="n">use_remote_preset</span><span class="o">=</span><span class="n">use_remote_preset</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">type_registry_preset_dict</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Type registry preset &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type_registry_preset</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">auto_discover</span><span class="p">:</span>
            <span class="c1"># Try to auto discover type registry preset by chain name</span>
            <span class="n">type_registry_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">type_registry_preset_dict</span> <span class="o">=</span> <span class="n">load_type_registry_preset</span><span class="p">(</span><span class="n">type_registry_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Auto set type_registry_preset to </span><span class="si">{</span><span class="n">type_registry_name</span><span class="si">}</span><span class="s2"> ...&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type_registry_preset</span> <span class="o">=</span> <span class="n">type_registry_name</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">type_registry_preset_dict</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">type_registry_preset_dict</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">type_registry_preset_dict</span><span class="p">:</span>
            <span class="c1"># Load type registries in runtime configuration</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">implements_scaleinfo</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="c1"># Only runtime with no embedded types in metadata need the default set of explicit defined types</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">update_type_registry</span><span class="p">(</span>
                    <span class="n">load_type_registry_preset</span><span class="p">(</span><span class="s2">&quot;legacy&quot;</span><span class="p">,</span> <span class="n">use_remote_preset</span><span class="o">=</span><span class="n">use_remote_preset</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_registry_preset</span> <span class="o">!=</span> <span class="s2">&quot;legacy&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">update_type_registry</span><span class="p">(</span><span class="n">type_registry_preset_dict</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_registry</span><span class="p">:</span>
            <span class="c1"># Load type registries in runtime configuration</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runtime_config</span><span class="o">.</span><span class="n">update_type_registry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_registry</span><span class="p">)</span></div>


<div class="viewcode-block" id="SubstrateInterface.register_extension">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.SubstrateInterface.register_extension">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extension</span><span class="p">:</span> <span class="n">Extension</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register an Extension and adds its functionality to the ExtensionRegistry</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        extension: Extension</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="ExtrinsicReceipt">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.ExtrinsicReceipt">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ExtrinsicReceipt</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Object containing information of submitted extrinsic. Block hash where extrinsic is included is required</span>
<span class="sd">        when retrieving triggered events or determine if extrinsic was succesfull</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substrate</span><span class="p">:</span> <span class="n">SubstrateInterface</span><span class="p">,</span> <span class="n">extrinsic_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">block_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">extrinsic_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">finalized</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Object containing information of submitted extrinsic. Block hash where extrinsic is included is required</span>
<span class="sd">        when retrieving triggered events or determine if extrinsic was succesfull</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        substrate</span>
<span class="sd">        extrinsic_hash</span>
<span class="sd">        block_hash</span>
<span class="sd">        finalized</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span> <span class="o">=</span> <span class="n">substrate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extrinsic_hash</span> <span class="o">=</span> <span class="n">extrinsic_hash</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span> <span class="o">=</span> <span class="n">block_hash</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">block_number</span> <span class="o">=</span> <span class="n">block_number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finalized</span> <span class="o">=</span> <span class="n">finalized</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__extrinsic_idx</span> <span class="o">=</span> <span class="n">extrinsic_idx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extrinsic</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__triggered_events</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__is_success</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__weight</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__total_fee_amount</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="ExtrinsicReceipt.get_extrinsic_identifier">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.ExtrinsicReceipt.get_extrinsic_identifier">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_extrinsic_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the on-chain identifier for this extrinsic in format &quot;[block_number]-[extrinsic_idx]&quot; e.g. 134324-2</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot create extrinsic identifier: block_hash is not set&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">block_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">get_block_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot create extrinsic identifier: unknown block_hash&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">block_number</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">extrinsic_idx</span><span class="si">}</span><span class="s1">&#39;</span></div>


<div class="viewcode-block" id="ExtrinsicReceipt.create_from_extrinsic_identifier">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.ExtrinsicReceipt.create_from_extrinsic_identifier">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_from_extrinsic_identifier</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span> <span class="n">substrate</span><span class="p">:</span> <span class="n">SubstrateInterface</span><span class="p">,</span> <span class="n">extrinsic_identifier</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExtrinsicReceipt&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an `ExtrinsicReceipt` with on-chain identifier for this extrinsic in format</span>
<span class="sd">        &quot;[block_number]-[extrinsic_idx]&quot; e.g. 134324-2</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        substrate: SubstrateInterface</span>
<span class="sd">        extrinsic_identifier: str</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ExtrinsicReceipt</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">id_parts</span> <span class="o">=</span> <span class="n">extrinsic_identifier</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">block_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">id_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">extrinsic_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">id_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Retrieve block hash</span>
        <span class="n">block_hash</span> <span class="o">=</span> <span class="n">substrate</span><span class="o">.</span><span class="n">get_block_hash</span><span class="p">(</span><span class="n">block_number</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">substrate</span><span class="o">=</span><span class="n">substrate</span><span class="p">,</span>
            <span class="n">block_hash</span><span class="o">=</span><span class="n">block_hash</span><span class="p">,</span>
            <span class="n">block_number</span><span class="o">=</span><span class="n">block_number</span><span class="p">,</span>
            <span class="n">extrinsic_idx</span><span class="o">=</span><span class="n">extrinsic_idx</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="ExtrinsicReceipt.retrieve_extrinsic">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.ExtrinsicReceipt.retrieve_extrinsic">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">retrieve_extrinsic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ExtrinsicReceipt can&#39;t retrieve events because it&#39;s unknown which block_hash it is &quot;</span>
                             <span class="s2">&quot;included, manually set block_hash or use `wait_for_inclusion` when sending extrinsic&quot;</span><span class="p">)</span>
        <span class="c1"># Determine extrinsic idx</span>

        <span class="n">block</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">get_block</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span><span class="p">)</span>

        <span class="n">extrinsics</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s1">&#39;extrinsics&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extrinsics</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extrinsic_idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__extrinsic_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_extrinsic_index</span><span class="p">(</span>
                    <span class="n">block_extrinsics</span><span class="o">=</span><span class="n">extrinsics</span><span class="p">,</span>
                    <span class="n">extrinsic_hash</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extrinsic_hash</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extrinsic_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">extrinsics</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">ExtrinsicNotFound</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">__extrinsic</span> <span class="o">=</span> <span class="n">extrinsics</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__extrinsic_idx</span><span class="p">]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">extrinsic_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the index of this extrinsic in containing block</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extrinsic_idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_extrinsic</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extrinsic_idx</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">extrinsic</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GenericExtrinsic</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the `Extrinsic` subject of this receipt</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Extrinsic</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extrinsic</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_extrinsic</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extrinsic</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">triggered_events</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets triggered events for submitted extrinsic. block_hash where extrinsic is included is required, manually</span>
<span class="sd">        set block_hash or use `wait_for_inclusion` when submitting extrinsic</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__triggered_events</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ExtrinsicReceipt can&#39;t retrieve events because it&#39;s unknown which block_hash it is &quot;</span>
                                 <span class="s2">&quot;included, manually set block_hash or use `wait_for_inclusion` when sending extrinsic&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrinsic_idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_extrinsic</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">__triggered_events</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">get_events</span><span class="p">(</span><span class="n">block_hash</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">extrinsic_idx</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrinsic_idx</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__triggered_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__triggered_events</span>

<div class="viewcode-block" id="ExtrinsicReceipt.process_events">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.ExtrinsicReceipt.process_events">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">process_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">triggered_events</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">__total_fee_amount</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># Process fees</span>
            <span class="n">has_transaction_fee_paid_event</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">triggered_events</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;module_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TransactionPayment&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;event_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TransactionFeePaid&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__total_fee_amount</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;actual_fee&#39;</span><span class="p">]</span>
                    <span class="n">has_transaction_fee_paid_event</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># Process other events</span>
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">triggered_events</span><span class="p">:</span>

                <span class="c1"># Check events</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">implements_scaleinfo</span><span class="p">():</span>

                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;module_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;System&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;event_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ExtrinsicSuccess&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__is_success</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span> <span class="o">=</span> <span class="kc">None</span>

                        <span class="k">if</span> <span class="s1">&#39;dispatch_info&#39;</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">]:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">__weight</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;dispatch_info&#39;</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># Backwards compatibility</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">__weight</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>

                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;module_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;System&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;event_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ExtrinsicFailed&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__is_success</span> <span class="o">=</span> <span class="kc">False</span>

                        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                            <span class="n">dispatch_info</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;dispatch_info&#39;</span><span class="p">]</span>
                            <span class="n">dispatch_error</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;dispatch_error&#39;</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># Backwards compatibility</span>
                            <span class="n">dispatch_info</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">dispatch_error</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">__weight</span> <span class="o">=</span> <span class="n">dispatch_info</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>

                        <span class="k">if</span> <span class="s1">&#39;Module&#39;</span> <span class="ow">in</span> <span class="n">dispatch_error</span><span class="p">:</span>

                            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">dispatch_error</span><span class="p">[</span><span class="s1">&#39;Module&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                                <span class="n">module_index</span> <span class="o">=</span> <span class="n">dispatch_error</span><span class="p">[</span><span class="s1">&#39;Module&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                                <span class="n">error_index</span> <span class="o">=</span> <span class="n">dispatch_error</span><span class="p">[</span><span class="s1">&#39;Module&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">module_index</span> <span class="o">=</span> <span class="n">dispatch_error</span><span class="p">[</span><span class="s1">&#39;Module&#39;</span><span class="p">][</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
                                <span class="n">error_index</span> <span class="o">=</span> <span class="n">dispatch_error</span><span class="p">[</span><span class="s1">&#39;Module&#39;</span><span class="p">][</span><span class="s1">&#39;error&#39;</span><span class="p">]</span>

                            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">error_index</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                                <span class="c1"># Actual error index is first u8 in new [u8; 4] format</span>
                                <span class="n">error_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">error_index</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>

                            <span class="n">module_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get_module_error</span><span class="p">(</span>
                                <span class="n">module_index</span><span class="o">=</span><span class="n">module_index</span><span class="p">,</span>
                                <span class="n">error_index</span><span class="o">=</span><span class="n">error_index</span>
                            <span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span> <span class="o">=</span> <span class="p">{</span>
                                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;Module&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">module_error</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                <span class="s1">&#39;docs&#39;</span><span class="p">:</span> <span class="n">module_error</span><span class="o">.</span><span class="n">docs</span>
                            <span class="p">}</span>
                        <span class="k">elif</span> <span class="s1">&#39;BadOrigin&#39;</span> <span class="ow">in</span> <span class="n">dispatch_error</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span> <span class="o">=</span> <span class="p">{</span>
                                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;BadOrigin&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;docs&#39;</span><span class="p">:</span> <span class="s1">&#39;Bad origin&#39;</span>
                            <span class="p">}</span>
                        <span class="k">elif</span> <span class="s1">&#39;CannotLookup&#39;</span> <span class="ow">in</span> <span class="n">dispatch_error</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span> <span class="o">=</span> <span class="p">{</span>
                                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CannotLookup&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;docs&#39;</span><span class="p">:</span> <span class="s1">&#39;Cannot lookup&#39;</span>
                            <span class="p">}</span>
                        <span class="k">elif</span> <span class="s1">&#39;Other&#39;</span> <span class="ow">in</span> <span class="n">dispatch_error</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span> <span class="o">=</span> <span class="p">{</span>
                                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Other&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;docs&#39;</span><span class="p">:</span> <span class="s1">&#39;Unspecified error occurred&#39;</span>
                            <span class="p">}</span>

                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">has_transaction_fee_paid_event</span><span class="p">:</span>

                        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;module_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Treasury&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;event_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Deposit&#39;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">__total_fee_amount</span> <span class="o">+=</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c1"># Backwards compatibility</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">__total_fee_amount</span> <span class="o">+=</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;module_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Balances&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;event_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Deposit&#39;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">__total_fee_amount</span> <span class="o">+=</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;amount&#39;</span><span class="p">]</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c1"># Backwards compatibility</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">__total_fee_amount</span> <span class="o">+=</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">event_module</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;System&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;ExtrinsicSuccess&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__is_success</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span> <span class="o">=</span> <span class="kc">None</span>

                        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DispatchInfo&#39;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">__weight</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>

                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">event_module</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;System&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;ExtrinsicFailed&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__is_success</span> <span class="o">=</span> <span class="kc">False</span>

                        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DispatchError&#39;</span><span class="p">:</span>
                                <span class="k">if</span> <span class="s1">&#39;Module&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]:</span>

                                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">][</span><span class="s1">&#39;Module&#39;</span><span class="p">][</span><span class="s1">&#39;error&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                                        <span class="c1"># Actual error index is first u8 in new [u8; 4] format (e.g. 0x01000000)</span>
                                        <span class="n">error_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">][</span><span class="s1">&#39;Module&#39;</span><span class="p">][</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">error_index</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">][</span><span class="s1">&#39;Module&#39;</span><span class="p">][</span><span class="s1">&#39;error&#39;</span><span class="p">]</span>

                                    <span class="n">module_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get_module_error</span><span class="p">(</span>
                                        <span class="n">module_index</span><span class="o">=</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">][</span><span class="s1">&#39;Module&#39;</span><span class="p">][</span><span class="s1">&#39;index&#39;</span><span class="p">],</span>
                                        <span class="n">error_index</span><span class="o">=</span><span class="n">error_index</span>
                                    <span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span> <span class="o">=</span> <span class="p">{</span>
                                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;Module&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">module_error</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                        <span class="s1">&#39;docs&#39;</span><span class="p">:</span> <span class="n">module_error</span><span class="o">.</span><span class="n">docs</span>
                                    <span class="p">}</span>
                                <span class="k">elif</span> <span class="s1">&#39;BadOrigin&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]:</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span> <span class="o">=</span> <span class="p">{</span>
                                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;BadOrigin&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;docs&#39;</span><span class="p">:</span> <span class="s1">&#39;Bad origin&#39;</span>
                                    <span class="p">}</span>
                                <span class="k">elif</span> <span class="s1">&#39;CannotLookup&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]:</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span> <span class="o">=</span> <span class="p">{</span>
                                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CannotLookup&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;docs&#39;</span><span class="p">:</span> <span class="s1">&#39;Cannot lookup&#39;</span>
                                    <span class="p">}</span>
                                <span class="k">elif</span> <span class="s1">&#39;Other&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]:</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span> <span class="o">=</span> <span class="p">{</span>
                                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Other&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;docs&#39;</span><span class="p">:</span> <span class="s1">&#39;Unspecified error occurred&#39;</span>
                                    <span class="p">}</span>

                            <span class="k">if</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DispatchInfo&#39;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">__weight</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>

                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">event_module</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Treasury&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Deposit&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__total_fee_amount</span> <span class="o">+=</span> <span class="n">event</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">event_module</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Balances&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Deposit&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__total_fee_amount</span> <span class="o">+=</span> <span class="n">event</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_success</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns `True` if `ExtrinsicSuccess` event is triggered, `False` in case of `ExtrinsicFailed`</span>
<span class="sd">        In case of False `error_message` will contain more details about the error</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_success</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_events</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_success</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">error_message</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the error message if the extrinsic failed in format e.g.:</span>

<span class="sd">        `{&#39;type&#39;: &#39;System&#39;, &#39;name&#39;: &#39;BadOrigin&#39;, &#39;docs&#39;: &#39;Bad origin&#39;}`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_success</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_events</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__error_message</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">weight</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Contains the actual weight when executing this extrinsic</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int (WeightV1) or dict (WeightV2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__weight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_events</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__weight</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">total_fee_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Contains the total fee costs deducted when executing this extrinsic. This includes fee for the validator (</span>
<span class="sd">        (`Balances.Deposit` event) and the fee deposited for the treasury (`Treasury.Deposit` event)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__total_fee_amount</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_events</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__total_fee_amount</span>

    <span class="c1"># Helper functions</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">__get_extrinsic_index</span><span class="p">(</span><span class="n">block_extrinsics</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">extrinsic_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the index of a provided extrinsic</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">extrinsic</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">block_extrinsics</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">extrinsic</span><span class="o">.</span><span class="n">extrinsic_hash</span> <span class="ow">and</span> <span class="sa">f</span><span class="s1">&#39;0x</span><span class="si">{</span><span class="n">extrinsic</span><span class="o">.</span><span class="n">extrinsic_hash</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">==</span> <span class="n">extrinsic_hash</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">idx</span>
        <span class="k">raise</span> <span class="n">ExtrinsicNotFound</span><span class="p">()</span>

    <span class="c1"># Backwards compatibility methods</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">yield</span> <span class="n">item</span>

<div class="viewcode-block" id="ExtrinsicReceipt.get">
<a class="viewcode-back" href="../../python-sdk/Reference/sdk_interface.html#sdk_interface.base.ExtrinsicReceipt.get">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span></div>
</div>



<span class="k">class</span><span class="w"> </span><span class="nc">QueryMapResult</span><span class="p">:</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">records</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">page_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">storage_function</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">params</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">block_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">substrate</span><span class="p">:</span> <span class="n">SubstrateInterface</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">last_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ignore_decoding_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">records</span> <span class="o">=</span> <span class="n">records</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page_size</span> <span class="o">=</span> <span class="n">page_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">=</span> <span class="n">module</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage_function</span> <span class="o">=</span> <span class="n">storage_function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span> <span class="o">=</span> <span class="n">block_hash</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span> <span class="o">=</span> <span class="n">substrate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_key</span> <span class="o">=</span> <span class="n">last_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_results</span> <span class="o">=</span> <span class="n">max_results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_decoding_errors</span> <span class="o">=</span> <span class="n">ignore_decoding_errors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loading_complete</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">retrieve_next_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_key</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">query_map</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">storage_function</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">storage_function</span><span class="p">,</span>
                                          <span class="n">params</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">page_size</span><span class="p">,</span> <span class="n">block_hash</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">block_hash</span><span class="p">,</span>
                                          <span class="n">start_key</span><span class="o">=</span><span class="n">start_key</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_results</span><span class="p">,</span>
                                          <span class="n">ignore_decoding_errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_decoding_errors</span><span class="p">)</span>

        <span class="c1"># Update last key from new result set to use as offset for next page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_key</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">last_key</span>

        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">records</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_index</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_results</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_results</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loading_complete</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">records</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_complete</span><span class="p">:</span>
            <span class="c1"># try to retrieve next page from node</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">records</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_next_page</span><span class="p">(</span><span class="n">start_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">last_key</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">records</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loading_complete</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">records</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_index</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">records</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Portaldot.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>